<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>R Regression Models | Data Science Workshops</title>
  <meta name="description" content="R Regression Models | Data Science Workshops" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="R Regression Models | Data Science Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R Regression Models | Data Science Workshops" />
  <meta name="github-repo" content="IQSS/dss-workshops" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Regression Models | Data Science Workshops" />
  
  <meta name="twitter:description" content="R Regression Models | Data Science Workshops" />
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Rintro.html"/>
<link rel="next" href="Rgraphics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science Workshop Materials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Table of Contents</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="part"><span><b>I General</b></span></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html"><i class="fa fa-check"></i>Data Science Tools</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#tools-for-working-with-data"><i class="fa fa-check"></i>Tools for working with data</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#the-puzzle-pieces"><i class="fa fa-check"></i>The puzzle pieces</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#data-analysis-building-blocks"><i class="fa fa-check"></i>Data analysis building blocks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#examples"><i class="fa fa-check"></i>Examples</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#old-school-example"><i class="fa fa-check"></i>Old-school example</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#something-old-something-new"><i class="fa fa-check"></i>Something old &amp; something new</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#a-modern-version"><i class="fa fa-check"></i>A modern version</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#data-storage-retrieval"><i class="fa fa-check"></i>Data storage &amp; retrieval</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#text-files"><i class="fa fa-check"></i>Text files</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#binary-files"><i class="fa fa-check"></i>Binary files</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#databases"><i class="fa fa-check"></i>Databases</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#distributed-file-storage"><i class="fa fa-check"></i>Distributed file storage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#programming-languages-statistics-packages"><i class="fa fa-check"></i>Programming languages &amp; statistics packages</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#programming-language-features"><i class="fa fa-check"></i>Programming language features</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#program-comparison"><i class="fa fa-check"></i>Program comparison</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#examples-read-data-from-a-file-summarize"><i class="fa fa-check"></i>Examples: Read data from a file &amp; summarize</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#examples-fit-a-linear-regression"><i class="fa fa-check"></i>Examples: Fit a linear regression</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#examples-extract-links-for-.html-file"><i class="fa fa-check"></i>Examples: Extract links for .html file</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#creating-reports"><i class="fa fa-check"></i>Creating reports</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#markup-languages"><i class="fa fa-check"></i>Markup languages</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#word-processors"><i class="fa fa-check"></i>Word processors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#text-editors-integrated-development-environments"><i class="fa fa-check"></i>Text editors &amp; Integrated Development Environments</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#language-specific-editors-ides"><i class="fa fa-check"></i>Language specific editors &amp; IDEs</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#general-purpose-editors-ides"><i class="fa fa-check"></i>General purpose editors &amp; IDEs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#literate-programming-notebooks"><i class="fa fa-check"></i>Literate programming &amp; notebooks</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#literate-programming"><i class="fa fa-check"></i>Literate programming</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#notebooks"><i class="fa fa-check"></i>Notebooks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#big-data-annoying-data-computationally-intensive-methods"><i class="fa fa-check"></i>Big data, annoying data, &amp; computationally intensive methods</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#computing-clusters-at-harvard"><i class="fa fa-check"></i>Computing clusters at Harvard</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#wrap-up"><i class="fa fa-check"></i>Wrap up</a><ul>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="DataScienceTools.html"><a href="DataScienceTools.html#resources"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="" data-path="Rinstall.html"><a href="Rinstall.html"><i class="fa fa-check"></i>R Installation</a><ul>
<li class="chapter" data-level="" data-path="Rinstall.html"><a href="Rinstall.html#troubleshooting-session"><i class="fa fa-check"></i>Troubleshooting session</a></li>
<li class="chapter" data-level="" data-path="Rinstall.html"><a href="Rinstall.html#materials"><i class="fa fa-check"></i>Materials</a></li>
<li class="chapter" data-level="" data-path="Rinstall.html"><a href="Rinstall.html#software"><i class="fa fa-check"></i>Software</a></li>
<li><a href="Rinstall.html#installing-the-tidyverse">Installing the <code>tidyverse</code></a><ul>
<li><a href="Rinstall.html#troubleshooting-tidyverse-installation">Troubleshooting <code>tidyverse</code> installation</a></li>
</ul></li>
<li><a href="Rinstall.html#installing-rmarkdown-optional">Installing <code>rmarkdown</code> (optional)</a></li>
<li class="chapter" data-level="" data-path="Rinstall.html"><a href="Rinstall.html#resources-1"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i>R Introduction</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#setup"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#class-structure"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#goals"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#r-basics"><i class="fa fa-check"></i>R basics</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#what-is-r"><i class="fa fa-check"></i>What is R?</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#why-use-r"><i class="fa fa-check"></i>Why use R?</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#how-does-r-work"><i class="fa fa-check"></i>How does R work?</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#interfaces"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#launch-a-session"><i class="fa fa-check"></i>Launch a session</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-0"><i class="fa fa-check"></i>Exercise 0</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#syntax-rules"><i class="fa fa-check"></i>Syntax rules</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#function-calls"><i class="fa fa-check"></i>Function calls</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#assignment"><i class="fa fa-check"></i>Assignment</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#asking-for-help"><i class="fa fa-check"></i>Asking for help</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#reading-data"><i class="fa fa-check"></i>Reading data</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#installing-using-packages"><i class="fa fa-check"></i>Installing &amp; using packages</a></li>
<li><a href="Rintro.html#the-tidyverse">The <code>tidyverse</code></a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#readers-for-common-file-types"><i class="fa fa-check"></i>Readers for common file types</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#baby-names-data"><i class="fa fa-check"></i>Baby names data</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#manipulating-data"><i class="fa fa-check"></i>Manipulating data</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#filter-select-arrange"><i class="fa fa-check"></i>Filter, select, &amp; arrange</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#logical-relational-operators"><i class="fa fa-check"></i>Logical &amp; relational operators</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-2.1"><i class="fa fa-check"></i>Exercise 2.1</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#pipe-operator"><i class="fa fa-check"></i>Pipe operator</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-2.2"><i class="fa fa-check"></i>Exercise 2.2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#plotting-data"><i class="fa fa-check"></i>Plotting data</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#creating-variables"><i class="fa fa-check"></i>Creating variables</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#create-or-modify-columns"><i class="fa fa-check"></i>Create or modify columns</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#operating-by-group"><i class="fa fa-check"></i>Operating by group</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#recoding-variables"><i class="fa fa-check"></i>Recoding variables</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#aggregating-variables"><i class="fa fa-check"></i>Aggregating variables</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#saving-work"><i class="fa fa-check"></i>Saving work</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#saving-individual-datasets"><i class="fa fa-check"></i>Saving individual datasets</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#saving-multiple-datasets"><i class="fa fa-check"></i>Saving multiple datasets</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#saving-loading-workspaces"><i class="fa fa-check"></i>Saving &amp; loading workspaces</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#wrap-up-1"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#feedback-1"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="Rintro.html"><a href="Rintro.html#resources-2"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html"><i class="fa fa-check"></i>R Regression Models</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#setup-1"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#class-structure-1"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#goals-1"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#launch-an-r-session"><i class="fa fa-check"></i>Launch an R session</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#packages"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#modeling-workflow"><i class="fa fa-check"></i>Modeling workflow</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#r-modeling-ecosystem"><i class="fa fa-check"></i>R modeling ecosystem</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#before-fitting-a-model"><i class="fa fa-check"></i>Before fitting a model</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#load-the-data"><i class="fa fa-check"></i>Load the data</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#examine-the-data"><i class="fa fa-check"></i>Examine the data</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#plot-the-data"><i class="fa fa-check"></i>Plot the data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#models-with-continuous-outcomes"><i class="fa fa-check"></i>Models with continuous outcomes</a><ul>
<li><a href="Rmodels.html#why-is-the-association-between-expense-sat-scores-negative">Why is the association between expense &amp; SAT scores <em>negative</em>?</a></li>
<li><a href="Rmodels.html#the-lm-class-methods">The <code>lm</code> class &amp; methods</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#ols-regression-assumptions"><i class="fa fa-check"></i>OLS regression assumptions</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#comparing-models"><i class="fa fa-check"></i>Comparing models</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#exercise-0-1"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#interactions-factors"><i class="fa fa-check"></i>Interactions &amp; factors</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#modeling-interactions"><i class="fa fa-check"></i>Modeling interactions</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#regression-with-categorical-predictors"><i class="fa fa-check"></i>Regression with categorical predictors</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#setting-factor-reference-groups-contrasts"><i class="fa fa-check"></i>Setting factor reference groups &amp; contrasts</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#models-with-binary-outcomes"><i class="fa fa-check"></i>Models with binary outcomes</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#logistic-regression-example"><i class="fa fa-check"></i>Logistic regression example</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#odds-ratios"><i class="fa fa-check"></i>Odds ratios</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#predicted-marginal-means"><i class="fa fa-check"></i>Predicted marginal means</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#multilevel-modeling"><i class="fa fa-check"></i>Multilevel modeling</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#multilevel-modeling-overview"><i class="fa fa-check"></i>Multilevel modeling overview</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#the-exam-data"><i class="fa fa-check"></i>The Exam data</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#the-null-model-icc"><i class="fa fa-check"></i>The null model &amp; ICC</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#adding-fixed-effects-predictors"><i class="fa fa-check"></i>Adding fixed-effects predictors</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#multiple-degree-of-freedom-comparisons"><i class="fa fa-check"></i>Multiple degree of freedom comparisons</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#random-slopes"><i class="fa fa-check"></i>Random slopes</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#test-the-significance-of-the-random-slope"><i class="fa fa-check"></i>Test the significance of the random slope</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#wrap-up-2"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#feedback-2"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="Rmodels.html"><a href="Rmodels.html#resources-3"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html"><i class="fa fa-check"></i>R Graphics</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#setup-2"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#class-structure-2"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#launch-an-r-session-1"><i class="fa fa-check"></i>Launch an R session</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#packages-1"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#goals-2"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li><a href="Rgraphics.html#why-ggplot2">Why <code>ggplot2</code>?</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#what-is-the-grammar-of-graphics"><i class="fa fa-check"></i>What is the Grammar Of Graphics?</a></li>
<li><a href="Rgraphics.html#ggplot2-vs-base-graphics"><code>ggplot2</code> VS base graphics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#geometric-objects-aesthetics"><i class="fa fa-check"></i>Geometric objects &amp; aesthetics</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#aesthetic-mapping"><i class="fa fa-check"></i>Aesthetic mapping</a></li>
<li><a href="Rgraphics.html#geometric-objects-geom">Geometric objects (<code>geom</code>)</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#aesthetic-mapping-vs-assignment"><i class="fa fa-check"></i>Aesthetic mapping VS assignment</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#mapping-variables-to-other-aesthetics"><i class="fa fa-check"></i>Mapping variables to other aesthetics</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#exercise-0-2"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#statistical-transformations"><i class="fa fa-check"></i>Statistical transformations</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#why-transform-data"><i class="fa fa-check"></i>Why transform data?</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#setting-arguments"><i class="fa fa-check"></i>Setting arguments</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#changing-the-transformation"><i class="fa fa-check"></i>Changing the transformation</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#scales"><i class="fa fa-check"></i>Scales</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#controlling-aesthetic-mapping"><i class="fa fa-check"></i>Controlling aesthetic mapping</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#common-scale-arguments"><i class="fa fa-check"></i>Common scale arguments</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#scale-modification-examples"><i class="fa fa-check"></i>Scale modification examples</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#using-different-color-scales"><i class="fa fa-check"></i>Using different color scales</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#available-scales"><i class="fa fa-check"></i>Available scales</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#faceting"><i class="fa fa-check"></i>Faceting</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#what-is-faceting"><i class="fa fa-check"></i>What is faceting?</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#what-is-the-trend-in-housing-prices-in-each-state"><i class="fa fa-check"></i>What is the trend in housing prices in each state?</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#faceting-to-the-rescue"><i class="fa fa-check"></i>Faceting to the rescue</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#themes"><i class="fa fa-check"></i>Themes</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#what-are-themes"><i class="fa fa-check"></i>What are themes?</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#overriding-theme-defaults"><i class="fa fa-check"></i>Overriding theme defaults</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#creating-saving-new-themes"><i class="fa fa-check"></i>Creating &amp; saving new themes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#saving-plots"><i class="fa fa-check"></i>Saving plots</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#the-1-faq"><i class="fa fa-check"></i>The #1 FAQ</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#map-aesthetic-to-different-columns"><i class="fa fa-check"></i>Map aesthetic to different columns</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#wrap-up-3"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#feedback-3"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="Rgraphics.html"><a href="Rgraphics.html#resources-4"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html"><i class="fa fa-check"></i>R Data Wrangling</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#setup-3"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#class-structure-3"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#launch-an-r-session-2"><i class="fa fa-check"></i>Launch an R session</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#packages-2"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#workshop-outline"><i class="fa fa-check"></i>Workshop Outline</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#working-with-excel-worksheets"><i class="fa fa-check"></i>Working with Excel worksheets</a><ul>
<li><a href="RDataWrangling.html#iterating-with-map">Iterating with <code>map()</code></a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#filtering-strings-using-regex"><i class="fa fa-check"></i>Filtering strings using regex</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#writing-your-own-functions"><i class="fa fa-check"></i>Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#reading-excel-data-files"><i class="fa fa-check"></i>Reading Excel data files</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#data-cleanup"><i class="fa fa-check"></i>Data cleanup</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#selecting-columns"><i class="fa fa-check"></i>Selecting columns</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#data-types-and-structures"><i class="fa fa-check"></i>Data types and structures</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#list-indexing"><i class="fa fa-check"></i>List indexing</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#dropping-missing-values"><i class="fa fa-check"></i>Dropping missing values</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#reshaping-from-wide-to-long"><i class="fa fa-check"></i>Reshaping from wide to long</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#data-organization-storage"><i class="fa fa-check"></i>Data organization &amp; storage</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#a-list-of-data-frames"><i class="fa fa-check"></i>A list of data frames</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#one-big-data-frame"><i class="fa fa-check"></i>One big data frame</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#complete-code"><i class="fa fa-check"></i>Complete code</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#wrap-up-4"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#feedback-4"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="RDataWrangling.html"><a href="RDataWrangling.html#resources-5"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Python</b></span></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html"><i class="fa fa-check"></i>Python Installation</a><ul>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#troubleshooting-session-1"><i class="fa fa-check"></i>Troubleshooting session</a></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#materials-1"><i class="fa fa-check"></i>Materials</a></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#software-1"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#jupyter-notebook-interfaces"><i class="fa fa-check"></i>Jupyter notebook interfaces</a><ul>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#launch-jupyterlab"><i class="fa fa-check"></i>Launch JupyterLab</a></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#launch-jupyter-notebook"><i class="fa fa-check"></i>Launch Jupyter Notebook</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonInstall.html"><a href="PythonInstall.html#resources-6"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html"><i class="fa fa-check"></i>Python Introduction</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#setup-4"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#class-structure-4"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#goals-3"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#python-basics"><i class="fa fa-check"></i>Python basics</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#what-is-python"><i class="fa fa-check"></i>What is Python?</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#why-use-python"><i class="fa fa-check"></i>Why use Python?</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#how-does-python-work"><i class="fa fa-check"></i>How does Python work?</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#interfaces-1"><i class="fa fa-check"></i>Interfaces</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#launch-jupyterlab-1"><i class="fa fa-check"></i>Launch JupyterLab</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#syntax-rules-1"><i class="fa fa-check"></i>Syntax rules</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#function-calls-1"><i class="fa fa-check"></i>Function calls</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#assignment-1"><i class="fa fa-check"></i>Assignment</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#reading-data-1"><i class="fa fa-check"></i>Reading data</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#object-methods"><i class="fa fa-check"></i>Object methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#using-object-methods-lists"><i class="fa fa-check"></i>Using object methods &amp; lists</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#splitting-a-string-into-a-list-of-words"><i class="fa fa-check"></i>Splitting a string into a list of words</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#working-with-lists"><i class="fa fa-check"></i>Working with lists</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#extracting-subsets-from-lists"><i class="fa fa-check"></i>Extracting subsets from lists</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#using-sets-to-count-unique-items"><i class="fa fa-check"></i>Using sets to count unique items</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#exercise-0-3"><i class="fa fa-check"></i>Exercise 0</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#control-flow"><i class="fa fa-check"></i>Control flow</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#logical-relational-operators-1"><i class="fa fa-check"></i>Logical &amp; relational operators</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#counting-list-elements"><i class="fa fa-check"></i>Counting list elements</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#iterating-over-collections-of-data"><i class="fa fa-check"></i>Iterating over collections of data</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#iterating-over-lists-using-for-loops"><i class="fa fa-check"></i>Iterating over lists using for-loops</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#organizing-results-in-dictionaries"><i class="fa fa-check"></i>Organizing results in dictionaries</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#importing-packages"><i class="fa fa-check"></i>Importing packages</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#wrap-up-5"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#feedback-5"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="PythonIntro.html"><a href="PythonIntro.html#resources-7"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html"><i class="fa fa-check"></i>Python Web-Scraping</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#setup-5"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#class-structure-5"><i class="fa fa-check"></i>Class Structure</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#goals-4"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#webscraping-background"><i class="fa fa-check"></i>Webscraping background</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#what-is-web-scraping"><i class="fa fa-check"></i>What is web scraping?</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#is-web-scraping-legal-is-it-ethical"><i class="fa fa-check"></i>Is web scraping legal? Is it ethical?</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#web-scraping-approaches"><i class="fa fa-check"></i>Web scraping approaches</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#how-does-the-web-work"><i class="fa fa-check"></i>How does the web work?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#retrieve-data-in-json-format-if-you-can"><i class="fa fa-check"></i>Retrieve data in JSON format if you can</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#examine-the-websites-structure"><i class="fa fa-check"></i>Examine the website’s structure</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#launch-jupyterlab-2"><i class="fa fa-check"></i>Launch JupyterLab</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#making-requests"><i class="fa fa-check"></i>Making requests</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#parsing-json-data"><i class="fa fa-check"></i>Parsing JSON data</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#organizing-saving-the-data"><i class="fa fa-check"></i>Organizing &amp; saving the data</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#iterating-to-retrieve-all-the-data"><i class="fa fa-check"></i>Iterating to retrieve all the data</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#exercise-0-4"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#parsing-html-if-you-have-to"><i class="fa fa-check"></i>Parsing HTML if you have to</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#document-object-model-dom"><i class="fa fa-check"></i>Document Object Model (DOM)</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#retrieving-html"><i class="fa fa-check"></i>Retrieving HTML</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#parsing-html-using-the-lxml-library"><i class="fa fa-check"></i>Parsing HTML using the lxml library</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#using-xpath-to-extract-content-from-html"><i class="fa fa-check"></i>Using XPath to extract content from HTML</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#iterating-to-retrieve-content-from-a-list-of-html-elements"><i class="fa fa-check"></i>Iterating to retrieve content from a list of HTML elements</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li><a href="PythonWebScrape.html#scrapy-for-large-complex-projects"><code>Scrapy</code>: for large / complex projects</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#browser-drivers-a-last-resort"><i class="fa fa-check"></i>Browser drivers: a last resort</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#wrap-up-6"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#feedback-6"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="PythonWebScrape.html"><a href="PythonWebScrape.html#resources-8"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Stata</b></span></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html"><i class="fa fa-check"></i>Stata Introduction</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#setup-6"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#software-materials"><i class="fa fa-check"></i>Software &amp; Materials</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#organization"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#goals-5"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#why-stata"><i class="fa fa-check"></i>Why stata?</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#stata-interface"><i class="fa fa-check"></i>Stata interface</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#do-files"><i class="fa fa-check"></i>Do-files</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#stata-help"><i class="fa fa-check"></i>Stata help</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#syntax-rules-2"><i class="fa fa-check"></i>Syntax rules</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#lets-get-started"><i class="fa fa-check"></i>Let’s get started</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#reading-data-2"><i class="fa fa-check"></i>Reading data</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#data-file-commands"><i class="fa fa-check"></i>Data file commands</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#a-note-about-path-names"><i class="fa fa-check"></i>A note about path names</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#wheres-my-data"><i class="fa fa-check"></i>Where’s my data?</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#reading-non-stata-data"><i class="fa fa-check"></i>Reading non-Stata data</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-0-5"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#statistics-graphs"><i class="fa fa-check"></i>Statistics &amp; graphs</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#frequently-used-commands"><i class="fa fa-check"></i>Frequently used commands</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#basic-graphing-commands"><i class="fa fa-check"></i>Basic graphing commands</a></li>
<li><a href="StataIntro.html#the-by-command">The <code>by</code> command</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-1-6"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#basic-data-management"><i class="fa fa-check"></i>Basic data management</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#labels"><i class="fa fa-check"></i>Labels</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#variable-value-labels"><i class="fa fa-check"></i>Variable &amp; value labels</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#working-on-subsets"><i class="fa fa-check"></i>Working on subsets</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#generating-replacing-variables"><i class="fa fa-check"></i>Generating &amp; replacing variables</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#use-drop-to-delete-variables-and-keep-to-keep-them"><i class="fa fa-check"></i>Use drop to delete variables and keep to keep them</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#alternatively-you-can-keep-options-you-want"><i class="fa fa-check"></i>Alternatively, you can keep options you want</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#exercise-solutions"><i class="fa fa-check"></i>Exercise solutions</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#ex-0-prototype"><i class="fa fa-check"></i>Ex 0: prototype</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#ex-1-prototype"><i class="fa fa-check"></i>Ex 1: prototype</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#ex-2-prototype"><i class="fa fa-check"></i>Ex 2: prototype</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#ex-3-prototype"><i class="fa fa-check"></i>Ex 3: prototype</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#ex-4-prototype"><i class="fa fa-check"></i>Ex 4: prototype</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#wrap-up-7"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#feedback-7"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="StataIntro.html"><a href="StataIntro.html#resources-9"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html"><i class="fa fa-check"></i>Stata Data Management</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#setup-7"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#software-materials-1"><i class="fa fa-check"></i>Software &amp; Materials</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#organization-1"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#goals-6"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#opening-files"><i class="fa fa-check"></i>Opening Files</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#generating-replacing-variables-1"><i class="fa fa-check"></i>Generating &amp; replacing variables</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#data-manipulation-commands"><i class="fa fa-check"></i>Data Manipulation Commands</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#generate-replace"><i class="fa fa-check"></i>Generate &amp; Replace</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#recode"><i class="fa fa-check"></i>Recode</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#egen"><i class="fa fa-check"></i>egen</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#exercise-0-6"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#by-processing"><i class="fa fa-check"></i>By processing</a><ul>
<li><a href="StataDatMan.html#the-bysort-command">The <code>bysort</code> Command</a></li>
<li><a href="StataDatMan.html#by-prefix-vs.-by-options"><code>by</code> prefix vs. <code>by</code> options</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#missing-values"><i class="fa fa-check"></i>Missing values</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#bulk-conversion-to-missing-values"><i class="fa fa-check"></i>Bulk Conversion to Missing Values</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#variable-types"><i class="fa fa-check"></i>Variable types</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#converting-to-from-strings"><i class="fa fa-check"></i>Converting to &amp; from Strings</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#converting-strings-to-datetime"><i class="fa fa-check"></i>Converting Strings to Date/Time</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#formatting-numbers-as-dates"><i class="fa fa-check"></i>Formatting Numbers as Dates</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#exercise-1-7"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#merging-appending-joining"><i class="fa fa-check"></i>Merging, appending, &amp; joining</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#appending-datasets"><i class="fa fa-check"></i>Appending Datasets</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#merging-datasets"><i class="fa fa-check"></i>Merging Datasets</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#merge-options"><i class="fa fa-check"></i>Merge Options</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#many-to-many-merges"><i class="fa fa-check"></i>Many-to-many merges</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#creating-summarized-data-sets"><i class="fa fa-check"></i>Creating summarized data sets</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#collapse"><i class="fa fa-check"></i>Collapse</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#exercise-solutions-1"><i class="fa fa-check"></i>Exercise Solutions</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#ex-0-prototype-1"><i class="fa fa-check"></i>Ex 0: prototype</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#ex-1-prototype-1"><i class="fa fa-check"></i>Ex 1: prototype</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#ex-2-prototype-1"><i class="fa fa-check"></i>Ex 2: prototype</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#wrap-up-8"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#feedback-8"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="StataDatMan.html"><a href="StataDatMan.html#resources-10"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html"><i class="fa fa-check"></i>Stata Modeling &amp; Graphing</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#setup-8"><i class="fa fa-check"></i>Setup</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#software-materials-2"><i class="fa fa-check"></i>Software &amp; Materials</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#organization-2"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#goals-7"><i class="fa fa-check"></i>Goals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#fitting-models"><i class="fa fa-check"></i>Fitting models</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#todays-dataset"><i class="fa fa-check"></i>Today’s Dataset</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#opening-files-1"><i class="fa fa-check"></i>Opening Files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#simple-regression"><i class="fa fa-check"></i>Simple regression</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#steps-for-running-regression"><i class="fa fa-check"></i>Steps for running regression</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#preliminaries"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#sat-scores-education-expenditures"><i class="fa fa-check"></i>SAT scores &amp; Education Expenditures</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#ols-assumptions"><i class="fa fa-check"></i>OLS assumptions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#multiple-regression"><i class="fa fa-check"></i>Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#preliminaries-1"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exercise-0-7"><i class="fa fa-check"></i>Exercise 0</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#interactions"><i class="fa fa-check"></i>Interactions</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#categorical-predictors"><i class="fa fa-check"></i>Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exercise-1-8"><i class="fa fa-check"></i>Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exporting-saving-results"><i class="fa fa-check"></i>Exporting &amp; saving results</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#regression-tables"><i class="fa fa-check"></i>Regression tables</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#saving-replaying"><i class="fa fa-check"></i>Saving &amp; replaying</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exporting-to-excel"><i class="fa fa-check"></i>Exporting to Excel</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#graphing-in-stata"><i class="fa fa-check"></i>Graphing in Stata</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#graphing-strategies"><i class="fa fa-check"></i>Graphing Strategies</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#terrible-graph"><i class="fa fa-check"></i>Terrible Graph</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#much-better-graph"><i class="fa fa-check"></i>Much Better Graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#univariate-graphics"><i class="fa fa-check"></i>Univariate Graphics</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#our-first-dataset"><i class="fa fa-check"></i>Our First Dataset</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#single-continuous-variables"><i class="fa fa-check"></i>Single Continuous Variables</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#single-categorical-variables"><i class="fa fa-check"></i>Single Categorical Variables</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exercise-2-6"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#bivariate-graphics"><i class="fa fa-check"></i>Bivariate Graphics</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#next-dataset"><i class="fa fa-check"></i>Next Dataset:</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#the-twoway-family"><i class="fa fa-check"></i>The Twoway Family</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#overlaying-twoway-graphs"><i class="fa fa-check"></i>Overlaying Twoway Graphs</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#twoway-line-graphs"><i class="fa fa-check"></i>Twoway Line Graphs</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exporting-graphs"><i class="fa fa-check"></i>Exporting Graphs</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#exercise-solutions-2"><i class="fa fa-check"></i>Exercise Solutions</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#ex-0-prototype-2"><i class="fa fa-check"></i>Ex 0: prototype</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#ex-1-prototype-2"><i class="fa fa-check"></i>Ex 1: prototype</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#ex-2-prototype-2"><i class="fa fa-check"></i>Ex 2: prototype</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#ex-3-prototype-1"><i class="fa fa-check"></i>Ex 3: prototype</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#wrap-up-9"><i class="fa fa-check"></i>Wrap-up</a><ul>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#feedback-9"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="StataModGraph.html"><a href="StataModGraph.html#resources-11"><i class="fa fa-check"></i>Resources</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-regression-models" class="section level1">
<h1>R Regression Models</h1>
<p><strong>Topics</strong></p>
<ul>
<li>Formula interface for model specification</li>
<li>Function methods for extracting quantities of interest from models</li>
<li>Contrasts to test specific hypotheses</li>
<li>Model comparisons</li>
<li>Predicted marginal effects</li>
</ul>
<div id="setup-1" class="section level2">
<h2>Setup</h2>
<div id="class-structure-1" class="section level3">
<h3>Class Structure</h3>
<ul>
<li>Informal — Ask questions at any time. Really!</li>
<li>Collaboration is encouraged - please spend a minute introducing yourself to your neighbors!</li>
</ul>
</div>
<div id="prerequisites-1" class="section level3">
<h3>Prerequisites</h3>
<p>This is an intermediate R course:</p>
<ul>
<li>Assumes working knowledge of R</li>
<li>Relatively fast-paced</li>
<li>This is not a statistics course! We will teach you <em>how</em> to fit models in R,
but we assume you know the theory behind the models.</li>
</ul>
</div>
<div id="goals-1" class="section level3">
<h3>Goals</h3>
<div class="alert alert-danger">
<p>We will learn about the R modeling ecosystem by fitting a variety of statistical models to
different datasets. In particular, our goals are to learn about:</p>
<ol style="list-style-type: decimal">
<li>Modeling workflow</li>
<li>Visualizing and summarizing data before modeling</li>
<li>Modeling continuous outcomes</li>
<li>Modeling binary outcomes</li>
<li>Modeling clustered data</li>
</ol>
<p>We will not spend much time <em>interpreting</em> the models we fit, since this is not a statistics workshop.
But, we will walk you through how model results are organized and orientate you to where you can find
typical quantities of interest.</p>
</div>
</div>
<div id="launch-an-r-session" class="section level3">
<h3>Launch an R session</h3>
<p>Start RStudio and create a new project:</p>
<ul>
<li>On Windows click the start button and search for RStudio. On Mac
RStudio will be in your applications folder.</li>
<li>In Rstudio go to <code>File -&gt; New Project</code>.</li>
<li>Choose <code>Existing Directory</code> and browse to the workshop materials directory on your desktop.</li>
<li>Choose <code>File -&gt; Open File</code> and select the file with the word “BLANK” in the name.</li>
</ul>
</div>
<div id="packages" class="section level3">
<h3>Packages</h3>
<p>You should have already installed the <code>tidyverse</code> and <code>rmarkdown</code>
packages onto your computer before the workshop
— see <a href="./Rinstall.html">R Installation</a>.
Now let’s load these packages into the search path of our R session.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="kw">library</span>(rmarkdown)</a></code></pre></div>
<p>Finally, lets install some packages that will help with modeling:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># install.packages(&quot;lme4&quot;)</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="kw">library</span>(lme4)  <span class="co"># for mixed models</span></a>
<a class="sourceLine" id="cb148-3" data-line-number="3"></a>
<a class="sourceLine" id="cb148-4" data-line-number="4"><span class="co"># install.packages(&quot;emmeans&quot;)</span></a>
<a class="sourceLine" id="cb148-5" data-line-number="5"><span class="kw">library</span>(emmeans)  <span class="co"># for marginal effects</span></a>
<a class="sourceLine" id="cb148-6" data-line-number="6"></a>
<a class="sourceLine" id="cb148-7" data-line-number="7"><span class="co"># install.packages(&quot;effects&quot;)</span></a>
<a class="sourceLine" id="cb148-8" data-line-number="8"><span class="kw">library</span>(effects)  <span class="co"># for predicted marginal means</span></a></code></pre></div>
</div>
</div>
<div id="modeling-workflow" class="section level2">
<h2>Modeling workflow</h2>
<p>Before we delve into the details of how to fit models in R, it’s worth taking a step
back and thinking more broadly about the components of the modeling process. These
can roughly be divided into 3 stages:</p>
<ol style="list-style-type: decimal">
<li>Pre-estimation</li>
<li>Estimation</li>
<li>Post-estimaton</li>
</ol>
<p>At each stage, the goal is to complete a different task (e.g., to clean data, fit a model, test a hypothesis),
but the process is sequential — we move through the stages in order (though often many times in one project!)</p>
<p><img src="R/Rmodels/images/R_model_pipeline.png" /></p>
<p>Throughout this workshop we will go through these stages several times as we fit different types of model.</p>
</div>
<div id="r-modeling-ecosystem" class="section level2">
<h2>R modeling ecosystem</h2>
<p>There are literally hundreds of R packages that provide model fitting functionality.
We’re going to focus on just two during this workshop — <code>stats</code>, from Base R, and
<code>lme4</code>. It’s a good idea to look at <a href="https://cran.r-project.org/web/views/">CRAN Task Views</a>
when trying to find a modeling package for your needs, as they provide an extensive
curated list. But, here’s a more digestable table showing some of the most popular
packages for particular types of model.</p>
<table>
<thead>
<tr class="header">
<th align="left">Models</th>
<th align="left">Packages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Generalized linear</td>
<td align="left"><code>stats</code>, <code>biglm</code>, <code>MASS</code>, <code>robustbase</code></td>
</tr>
<tr class="even">
<td align="left">Mixed effects</td>
<td align="left"><code>lme4</code>, <code>nlme</code>, <code>glmmTMB</code>, <code>MASS</code></td>
</tr>
<tr class="odd">
<td align="left">Econometric</td>
<td align="left"><code>pglm</code>, <code>VGAM</code>, <code>pscl</code>, <code>survival</code></td>
</tr>
<tr class="even">
<td align="left">Bayesian</td>
<td align="left"><code>brms</code>, <code>blme</code>, <code>MCMCglmm</code>, <code>rstan</code></td>
</tr>
<tr class="odd">
<td align="left">Machine learning</td>
<td align="left"><code>mlr</code>, <code>caret</code>, <code>h2o</code>, <code>tensorflow</code></td>
</tr>
</tbody>
</table>
</div>
<div id="before-fitting-a-model" class="section level2">
<h2>Before fitting a model</h2>
<div class="alert alert-info">
<p><strong>GOAL: To learn about the data by creating summaries and visualizations.</strong></p>
</div>
<p>One important part of the pre-estimation stage of model fitting, is gaining an understanding
of the data we wish to model by creating plots and summaries. Let’s do this now.</p>
<div id="load-the-data" class="section level3">
<h3>Load the data</h3>
<p>List the data files we’re going to work with:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="kw">list.files</span>(<span class="st">&quot;dataSets&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Exam.rds&quot;          &quot;NatHealth2008MI&quot;   &quot;NatHealth2011.rds&quot;
## [4] &quot;states.rds&quot;</code></pre>
<p>We’re going to use the <code>states</code> data first, which originally appeared in <em>Statistics with Stata</em> by Lawrence C. Hamilton.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">  <span class="co"># read the states data</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2">  states_data &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;dataSets/states.rds&quot;</span>)</a>
<a class="sourceLine" id="cb151-3" data-line-number="3"></a>
<a class="sourceLine" id="cb151-4" data-line-number="4">  <span class="co"># look at the last few rows</span></a>
<a class="sourceLine" id="cb151-5" data-line-number="5">  <span class="kw">tail</span>(states_data)</a></code></pre></div>
<pre><code>##            state  region     pop  area density metro waste energy miles toxic
## 46       Vermont N. East  563000  9249   60.87  23.4  0.69    232  10.4  1.81
## 47      Virginia   South 6187000 39598  156.25  72.5  1.45    306   9.7 12.87
## 48    Washington    West 4867000 66582   73.10  81.7  1.05    389   9.2  8.51
## 49 West Virginia   South 1793000 24087   74.44  36.4  0.95    415   8.6 21.30
##    green house senate csat vsat msat percent expense income high college
## 46 15.17    85     94  890  424  466      68    6738 34.717 80.8    24.3
## 47 18.72    33     54  890  424  466      60    4836 38.838 75.2    24.5
## 48 16.51    52     64  913  433  480      49    5000 36.338 83.8    22.9
## 49 51.14    48     57  926  441  485      17    4911 24.233 66.0    12.3
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 2 rows ]</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">csat</td>
<td align="left">Mean composite SAT score</td>
</tr>
<tr class="even">
<td align="left">expense</td>
<td align="left">Per pupil expenditures</td>
</tr>
<tr class="odd">
<td align="left">percent</td>
<td align="left">% HS graduates taking SAT</td>
</tr>
<tr class="even">
<td align="left">income</td>
<td align="left">Median household income, $1,000</td>
</tr>
<tr class="odd">
<td align="left">region</td>
<td align="left">Geographic region: West, N. East, South, Midwest</td>
</tr>
<tr class="even">
<td align="left">house</td>
<td align="left">House ’91 environ. voting, %</td>
</tr>
<tr class="odd">
<td align="left">senate</td>
<td align="left">Senate ’91 environ. voting, %</td>
</tr>
<tr class="even">
<td align="left">energy</td>
<td align="left">Per capita energy consumed, Btu</td>
</tr>
<tr class="odd">
<td align="left">metro</td>
<td align="left">Metropolitan area population, %</td>
</tr>
<tr class="even">
<td align="left">waste</td>
<td align="left">Per capita solid waste, tons</td>
</tr>
</tbody>
</table>
</div>
<div id="examine-the-data" class="section level3">
<h3>Examine the data</h3>
<p>Start by examining the data to check for problems.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">  <span class="co"># summary of expense and csat columns, all rows</span></a>
<a class="sourceLine" id="cb153-2" data-line-number="2">  sts_ex_sat &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb153-3" data-line-number="3"><span class="st">      </span>states_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-4" data-line-number="4"><span class="st">      </span><span class="kw">select</span>(expense, csat)</a>
<a class="sourceLine" id="cb153-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb153-6" data-line-number="6">  <span class="kw">summary</span>(sts_ex_sat)</a></code></pre></div>
<pre><code>##     expense          csat       
##  Min.   :2960   Min.   : 832.0  
##  1st Qu.:4352   1st Qu.: 888.0  
##  Median :5000   Median : 926.0  
##  Mean   :5236   Mean   : 944.1  
##  3rd Qu.:5794   3rd Qu.: 997.0  
##  Max.   :9259   Max.   :1093.0</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1">  <span class="co"># correlation between expense and csat</span></a>
<a class="sourceLine" id="cb155-2" data-line-number="2">  <span class="kw">cor</span>(sts_ex_sat, <span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>) </a></code></pre></div>
<pre><code>##            expense       csat
## expense  1.0000000 -0.4662978
## csat    -0.4662978  1.0000000</code></pre>
</div>
<div id="plot-the-data" class="section level3">
<h3>Plot the data</h3>
<p>Plot the data to look for multivariate outliers, non-linear relationships etc.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">  <span class="co"># scatter plot of expense vs csat</span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2">  <span class="kw">plot</span>(sts_ex_sat)</a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-85-1.png" width="672" /></p>
<p>Obviously, in a real project, you would want to spend more time investigating the data,
but we’ll now move on to modeling.</p>
</div>
</div>
<div id="models-with-continuous-outcomes" class="section level2">
<h2>Models with continuous outcomes</h2>
<div class="alert alert-info">
<p><strong>GOAL: To learn about the R modeling ecosystem by fitting ordinary least squares (OLS) models.</strong> In particular:</p>
<ol style="list-style-type: decimal">
<li>Formula representation of a model specification</li>
<li>Model classes</li>
<li>Function methods</li>
<li>Model comparison</li>
</ol>
</div>
<p>Once the data have been inspected and cleaned, we can start estimating models.
The simplest models (but those with the most assumptions) are those for continuous and unbounded outcomes.
Typically, for these outcomes, we’d use a model estimated using Ordinary Least Lquares (OLS),
which in R can be fit with the <code>lm()</code> (linear model) function.</p>
<p>To fit a model in R, we first have to convert our theoretical model into
a <code>formula</code> — a symbolic representation of the model in R syntax:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="co"># formula for model specification</span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2">outcome <span class="op">~</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2 <span class="op">+</span><span class="st"> </span>pred3</a>
<a class="sourceLine" id="cb158-3" data-line-number="3"></a>
<a class="sourceLine" id="cb158-4" data-line-number="4"><span class="co"># </span><span class="al">NOTE</span><span class="co"> the ~ is a tilde</span></a></code></pre></div>
<p>For example, the following model predicts SAT scores based on per-pupil expenditures:</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
csat_i = \beta_01 + \beta_1expense_i + \epsilon_i
\]</span></p>
</div>
<p>We can use <code>lm()</code> to fit this model:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">  <span class="co"># Fit our regression model</span></a>
<a class="sourceLine" id="cb159-2" data-line-number="2">  sat_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>expense, <span class="co"># regression formula</span></a>
<a class="sourceLine" id="cb159-3" data-line-number="3">                <span class="dt">data =</span> states_data) <span class="co"># data </span></a>
<a class="sourceLine" id="cb159-4" data-line-number="4">                </a>
<a class="sourceLine" id="cb159-5" data-line-number="5">  <span class="co"># Summarize and print the results</span></a>
<a class="sourceLine" id="cb159-6" data-line-number="6">  <span class="kw">summary</span>(sat_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="co"># show regression coefficients table</span></a></code></pre></div>
<pre><code>##                  Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 1060.73244395 32.700896736 32.437412 8.878411e-35
## expense       -0.02227565  0.006037115 -3.689783 5.630902e-04</code></pre>
<div id="why-is-the-association-between-expense-sat-scores-negative" class="section level3">
<h3>Why is the association between expense &amp; SAT scores <em>negative</em>?</h3>
<p>Many people find it surprising that the per-capita expenditure on students is negatively related to SAT scores. The beauty of multiple regression is that we can try to pull these apart. What would the association between expense and SAT scores be if there were no difference among the states in the percentage of students taking the SAT?</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1">  <span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>expense <span class="op">+</span><span class="st"> </span>percent, <span class="dt">data =</span> states_data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb161-2" data-line-number="2"><span class="st">  </span><span class="kw">summary</span>() </a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = csat ~ 1 + expense + percent, data = states_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -62.921 -24.318   1.741  15.502  75.623 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 989.807403  18.395770  53.806  &lt; 2e-16 ***
## expense       0.008604   0.004204   2.046   0.0462 *  
## percent      -2.537700   0.224912 -11.283 4.21e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.62 on 48 degrees of freedom
## Multiple R-squared:  0.7857, Adjusted R-squared:  0.7768 
## F-statistic: 88.01 on 2 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="the-lm-class-methods" class="section level3">
<h3>The <code>lm</code> class &amp; methods</h3>
<p>Okay, we fitted our model. Now what? Typically, the main goal in the <strong>post-estimation stage</strong> of analysis
is to extract <strong>quantities of interest</strong> from our fitted model. These quantities could be things like:</p>
<ol style="list-style-type: decimal">
<li>Testing whether one group is different on average from another group</li>
<li>Generating average response values from the model for interesting combinations of predictor values</li>
<li>Calculating interval estimates for particular coefficients</li>
</ol>
<p>But before we can do any of that, we need to know more about <strong>what a fitted model actually is,</strong>
<strong>what information it contains, and how we can extract from it information that we want to report</strong>.</p>
<p>Let’s start by examining the model object:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1">  <span class="kw">class</span>(sat_mod)</a></code></pre></div>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1">  <span class="kw">str</span>(sat_mod)</a></code></pre></div>
<pre><code>## List of 12
##  $ coefficients : Named num [1:2] 1060.7324 -0.0223
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;expense&quot;
##  $ residuals    : Named num [1:51] 11.1 44.8 -32.7 26.7 -63.7 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:51] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ effects      : Named num [1:51] -6742.2 220.7 -31.7 29.7 -63.2 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:51] &quot;(Intercept)&quot; &quot;expense&quot; &quot;&quot; &quot;&quot; ...
##  $ rank         : int 2
##  $ fitted.values: Named num [1:51] 980 875 965 978 961 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:51] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ assign       : int [1:2] 0 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:51, 1:2] -7.14 0.14 0.14 0.14 0.14 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:51] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;expense&quot;
##   .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
##   ..$ qraux: num [1:2] 1.14 1.33
##   ..$ pivot: int [1:2] 1 2
##   ..$ tol  : num 1e-07
##   ..$ rank : int 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
##  $ df.residual  : int 49
##  $ xlevels      : Named list()
##  $ call         : language lm(formula = csat ~ 1 + expense, data = states_data)
##  $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language csat ~ 1 + expense
##   .. ..- attr(*, &quot;variables&quot;)= language list(csat, expense)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:2] &quot;csat&quot; &quot;expense&quot;
##   .. .. .. ..$ : chr &quot;expense&quot;
##   .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;expense&quot;
##   .. ..- attr(*, &quot;order&quot;)= int 1
##   .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(csat, expense)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;csat&quot; &quot;expense&quot;
##  $ model        :&#39;data.frame&#39;:   51 obs. of  2 variables:
##   ..$ csat   : int [1:51] 991 920 932 1005 897 959 897 892 840 882 ...
##   ..$ expense: int [1:51] 3627 8330 4309 3700 4491 5064 7602 5865 9259 5276 ...
##   ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language csat ~ 1 + expense
##   .. .. ..- attr(*, &quot;variables&quot;)= language list(csat, expense)
##   .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. ..$ : chr [1:2] &quot;csat&quot; &quot;expense&quot;
##   .. .. .. .. ..$ : chr &quot;expense&quot;
##   .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;expense&quot;
##   .. .. ..- attr(*, &quot;order&quot;)= int 1
##   .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, &quot;predvars&quot;)= language list(csat, expense)
##   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;csat&quot; &quot;expense&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;lm&quot;</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1">  <span class="kw">names</span>(sat_mod)</a></code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1">  <span class="kw">methods</span>(<span class="dt">class =</span> <span class="kw">class</span>(sat_mod))</a></code></pre></div>
<pre><code>##  [1] add1           alias          anova          case.names     coerce        
##  [6] confint        cooks.distance deviance       dfbeta         dfbetas       
## [11] drop1          dummy.coef     Effect         effects        emm_basis     
## [16] extractAIC     family         formula        fortify        hatvalues     
## [21] influence      initialize     kappa          labels         logLik        
## [26] model.frame    model.matrix   nobs           plot           predict       
## [31] print          proj           qqnorm         qr             recover_data  
## [36] residuals      rstandard      rstudent       show           simulate      
## [41] slotsFromS3    summary        variable.names vcov          
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>We can use <code>function methods</code> to get more information about the fit:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1">  <span class="kw">summary</span>(sat_mod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = csat ~ 1 + expense, data = states_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -131.811  -38.085    5.607   37.852  136.495 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.061e+03  3.270e+01   32.44  &lt; 2e-16 ***
## expense     -2.228e-02  6.037e-03   -3.69 0.000563 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 59.81 on 49 degrees of freedom
## Multiple R-squared:  0.2174, Adjusted R-squared:  0.2015 
## F-statistic: 13.61 on 1 and 49 DF,  p-value: 0.0005631</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1">  <span class="kw">summary</span>(sat_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>##                  Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 1060.73244395 32.700896736 32.437412 8.878411e-35
## expense       -0.02227565  0.006037115 -3.689783 5.630902e-04</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1">  <span class="kw">methods</span>(<span class="st">&quot;summary&quot;</span>)</a></code></pre></div>
<pre><code>##   [1] summary,ANY-method             summary,DBIObject-method      
##   [3] summary,diagonalMatrix-method  summary,sparseMatrix-method   
##   [5] summary.aareg*                 summary.allFit*               
##   [7] summary.aov                    summary.aovlist*              
##   [9] summary.aspell*                summary.cch*                  
##  [11] summary.check_packages_in_dir* summary.connection            
##  [13] summary.corAR1*                summary.corARMA*              
##  [15] summary.corCAR1*               summary.corCompSymm*          
##  [17] summary.corExp*                summary.corGaus*              
##  [19] summary.corIdent*              summary.corLin*               
##  [21] summary.corNatural*            summary.corRatio*             
##  [23] summary.corSpher*              summary.corStruct*            
##  [25] summary.corSymm*               summary.coxph*                
##  [27] summary.coxph.penal*           summary.data.frame            
##  [29] summary.Date                   summary.DBIrepdesign*         
##  [31] summary.DBIsvydesign*          summary.default               
##  [33] summary.Duration*              summary.ecdf*                 
##  [35] summary.eff*                   summary.efflatent*            
##  [37] summary.efflist*               summary.effpoly*              
##  [39] summary.emm_list*              summary.emmGrid*              
##  [41] summary.factor                 summary.ggplot*               
##  [43] summary.glht*                  summary.glht_list*            
##  [45] summary.glm                    summary.gls*                  
##  [47] summary.hcl_palettes*          summary.infl*                 
##  [49] summary.Interval*              summary.lm                    
##  [51] summary.lme*                   summary.lmList*               
##  [53] summary.lmList4*               summary.loess*                
##  [55] summary.loglm*                 summary.manova                
##  [57] summary.matrix                 summary.mcmc*                 
##  [59] summary.mcmc.list*             summary.merMod*               
##  [61] summary.MIresult*              summary.mlm*                  
##  [63] summary.mlm.efflist*           summary.modelStruct*          
##  [65] summary.multinom*              summary.negbin*               
##  [67] summary.nls*                   summary.nlsList*              
##  [69] summary.nnet*                  summary.ODBCrepdesign*        
##  [71] summary.ODBCsvydesign*         summary.packageStatus*        
##  [73] summary.pdBlocked*             summary.pdCompSymm*           
##  [75] summary.pdDiag*                summary.pdIdent*              
##  [77] summary.pdLogChol*             summary.pdMat*                
##  [79] summary.pdNatural*             summary.pdSymm*               
##  [81] summary.Period*                summary.polr*                 
##  [83] summary.POSIXct                summary.POSIXlt               
##  [85] summary.ppr*                   summary.pps*                  
##  [87] summary.prcomp*                summary.prcomplist*           
##  [89] summary.predictorefflist*      summary.princomp*             
##  [91] summary.proc_time              summary.pyears*               
##  [93] summary.ratetable*             summary.reStruct*             
##  [95] summary.rlang_error*           summary.rlang_trace*          
##  [97] summary.rlm*                   summary.shingle*              
##  [99] summary.srcfile                summary.srcref                
##  [ reached getOption(&quot;max.print&quot;) -- omitted 36 entries ]
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1">  <span class="kw">confint</span>(sat_mod)</a></code></pre></div>
<pre><code>##                    2.5 %        97.5 %
## (Intercept) 995.01753164 1126.44735626
## expense      -0.03440768   -0.01014361</code></pre>
<p>How does R know which method to call for a given object?
R uses <code>generic functions</code>, which provide access to <code>methods</code>.
Method dispatch takes place based on the <code>class</code> of the
first argument to the generic function. For example, for the generic
function <code>summary()</code> and an object of class <code>lm</code>, the method
dispatched will be <code>summary.lm()</code>. Function methods always take
the form <code>generic.method()</code>:</p>
<p><img src="R/Rmodels/images/methods.png" /></p>
<p>It’s always worth examining what function methods are available for the class of model you’re fitting.
Here’s a summary table of some of the most often used methods. These are post-estimation tools you
will want in your toolbox:</p>
<table>
<colgroup>
<col width="17%" />
<col width="18%" />
<col width="64%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>summary()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">standard errors, test statistics, p-values, GOF stats</td>
</tr>
<tr class="even">
<td align="left"><code>confint()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">confidence intervals</td>
</tr>
<tr class="odd">
<td align="left"><code>anova()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">anova table (one model), model comparison (&gt; one model)</td>
</tr>
<tr class="even">
<td align="left"><code>coef()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">point estimates</td>
</tr>
<tr class="odd">
<td align="left"><code>drop1()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">model comparison</td>
</tr>
<tr class="even">
<td align="left"><code>predict()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">predicted response values</td>
</tr>
<tr class="odd">
<td align="left"><code>fitted()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">predicted response values (for observed data)</td>
</tr>
<tr class="even">
<td align="left"><code>residuals()</code></td>
<td align="left"><code>stats</code> base R</td>
<td align="left">residuals</td>
</tr>
<tr class="odd">
<td align="left"><code>fixef()</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">fixed effect point estimates (mixed models only)</td>
</tr>
<tr class="even">
<td align="left"><code>ranef()</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">random effect point estimates (mixed models only)</td>
</tr>
<tr class="odd">
<td align="left"><code>coef()</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">empirical Bayes estimates (mixed models only)</td>
</tr>
<tr class="even">
<td align="left"><code>allEffects()</code></td>
<td align="left"><code>effects</code></td>
<td align="left">predicted marginal means</td>
</tr>
<tr class="odd">
<td align="left"><code>emmeans()</code></td>
<td align="left"><code>emmeans</code></td>
<td align="left">predicted marginal means &amp; marginal effects</td>
</tr>
<tr class="even">
<td align="left"><code>margins()</code></td>
<td align="left"><code>margins</code></td>
<td align="left">predicted marginal means &amp; marginal effects</td>
</tr>
</tbody>
</table>
</div>
<div id="ols-regression-assumptions" class="section level3">
<h3>OLS regression assumptions</h3>
<p>OLS regression relies on several assumptions, including:</p>
<ol style="list-style-type: decimal">
<li>The model includes all relevant variables (i.e., no omitted variable bias).</li>
<li>The model is linear in the parameters (i.e., the coefficients and error term).</li>
<li>The error term has an expected value of zero.</li>
<li>All right-hand-side variables are uncorrelated with the error term.</li>
<li>No right-hand-side variables are a perfect linear function of other RHS variables.</li>
<li>Observations of the error term are uncorrelated with each other.</li>
<li>The error term has constant variance (i.e., homoscedasticity).</li>
<li>(Optional - only needed for inference). The error term is normally distributed.</li>
</ol>
<p>Investigate assumptions #7 and #8 visually by plotting your model:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># splits the plotting window into 4 panels</span></a>
<a class="sourceLine" id="cb179-2" data-line-number="2">  <span class="kw">plot</span>(sat_mod)</a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-91-1.png" width="672" /></p>
</div>
<div id="comparing-models" class="section level3">
<h3>Comparing models</h3>
<p>Do congressional voting patterns predict SAT scores over and above expense? Fit two models and compare them:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">  <span class="co"># fit another model, adding house and senate as predictors</span></a>
<a class="sourceLine" id="cb180-2" data-line-number="2">  sat_voting_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>expense <span class="op">+</span><span class="st"> </span>house <span class="op">+</span><span class="st"> </span>senate,</a>
<a class="sourceLine" id="cb180-3" data-line-number="3">                        <span class="dt">data =</span> <span class="kw">na.omit</span>(states_data))</a>
<a class="sourceLine" id="cb180-4" data-line-number="4"></a>
<a class="sourceLine" id="cb180-5" data-line-number="5">  <span class="kw">summary</span>(sat_voting_mod) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>##                  Estimate   Std. Error    t value     Pr(&gt;|t|)
## (Intercept) 1082.93438041 38.633812740 28.0307405 1.067795e-29
## expense       -0.01870832  0.009691494 -1.9303852 6.001998e-02
## house         -1.44243754  0.600478382 -2.4021473 2.058666e-02
## senate         0.49817861  0.513561356  0.9700469 3.373256e-01</code></pre>
<p>Why are we using <code>na.omit()</code>? Let’s see what <code>na.omit()</code> does.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="co"># fake data</span></a>
<a class="sourceLine" id="cb182-2" data-line-number="2">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb182-3" data-line-number="3">  <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb182-4" data-line-number="4">  <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb182-5" data-line-number="5">  <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="ot">NA</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb182-6" data-line-number="6">dat</a></code></pre></div>
<pre><code>##   x  y  z
## 1 1  3  6
## 2 2  2 NA
## 3 3  1  2
## 4 4 NA  7
## 5 5  5  3</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">na.omit</span>(dat) <span class="co"># listwise deletion of observations</span></a></code></pre></div>
<pre><code>##   x y z
## 1 1 3 6
## 3 3 1 2
## 5 5 5 3</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="co"># also see</span></a>
<a class="sourceLine" id="cb186-2" data-line-number="2"><span class="co"># ?complete.cases</span></a>
<a class="sourceLine" id="cb186-3" data-line-number="3">dat[<span class="kw">with</span>(dat, <span class="kw">complete.cases</span>(x, y, z)), ]</a></code></pre></div>
<pre><code>##   x y z
## 1 1 3 6
## 3 3 1 2
## 5 5 5 3</code></pre>
<p>To compare models, we must fit them to the same data. This is why we need <code>na.omit()</code>.
Now let’s update our first model using <code>na.omit()</code>:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1">  sat_mod &lt;-<span class="st"> </span><span class="kw">update</span>(sat_mod, <span class="dt">data =</span> <span class="kw">na.omit</span>(states_data))</a>
<a class="sourceLine" id="cb188-2" data-line-number="2"></a>
<a class="sourceLine" id="cb188-3" data-line-number="3">  <span class="co"># compare using an F-test with the anova() function</span></a>
<a class="sourceLine" id="cb188-4" data-line-number="4">  <span class="kw">anova</span>(sat_mod, sat_voting_mod)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: csat ~ 1 + expense
## Model 2: csat ~ 1 + expense + house + senate
##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
## 1     46 169050                              
## 2     44 149284  2     19766 2.9128 0.06486 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="exercise-0-1" class="section level3">
<h3>Exercise 0</h3>
<p><strong>Ordinary least squares regression</strong></p>
<p>Use the <em>states.rds</em> data set. Fit a model predicting energy consumed per capita (energy) from the percentage of residents living in metropolitan areas (<code>metro</code>). Be sure to</p>
<ol style="list-style-type: decimal">
<li>Examine/plot the data before fitting the model</li>
</ol>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Print and interpret the model <code>summary()</code></li>
</ol>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><code>plot()</code> the model to look for deviations from modeling assumptions</li>
</ol>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Select one or more additional predictors to add to your model and repeat steps 1-3. Is this model significantly better than the model with <code>metro</code> as the only predictor?</li>
</ol>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<details>
<summary><span style="color:red"><b>Click for Exercise 0 Solution</b></span></summary>
<div class="alert alert-success">
<p>Use the <em>states.rds</em> data set.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">  states &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;dataSets/states.rds&quot;</span>)</a></code></pre></div>
<p>Fit a model predicting energy consumed per capita (energy) from the percentage of residents living in metropolitan areas (metro). Be sure to:</p>
<ol style="list-style-type: decimal">
<li>Examine/plot the data before fitting the model.</li>
</ol>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">  states_en_met &lt;-<span class="st"> </span><span class="kw">subset</span>(states, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;metro&quot;</span>, <span class="st">&quot;energy&quot;</span>))</a>
<a class="sourceLine" id="cb195-2" data-line-number="2">  <span class="kw">summary</span>(states_en_met)</a></code></pre></div>
<pre><code>##      metro            energy     
##  Min.   : 20.40   Min.   :200.0  
##  1st Qu.: 46.98   1st Qu.:285.0  
##  Median : 67.55   Median :320.0  
##  Mean   : 64.07   Mean   :354.5  
##  3rd Qu.: 81.58   3rd Qu.:371.5  
##  Max.   :100.00   Max.   :991.0  
##  NA&#39;s   :1        NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1">  <span class="kw">plot</span>(states_en_met)</a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-100-1.png" width="672" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">  <span class="kw">cor</span>(states_en_met, <span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>)</a></code></pre></div>
<pre><code>##             metro     energy
## metro   1.0000000 -0.3397445
## energy -0.3397445  1.0000000</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Print and interpret the model <code>summary()</code>.</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">  mod_en_met &lt;-<span class="st"> </span><span class="kw">lm</span>(energy <span class="op">~</span><span class="st"> </span>metro, <span class="dt">data =</span> states)</a>
<a class="sourceLine" id="cb200-2" data-line-number="2">  <span class="kw">summary</span>(mod_en_met)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = energy ~ metro, data = states)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -215.51  -64.54  -30.87   18.71  583.97 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 501.0292    61.8136   8.105 1.53e-10 ***
## metro        -2.2871     0.9139  -2.503   0.0158 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 140.2 on 48 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.1154, Adjusted R-squared:  0.097 
## F-statistic: 6.263 on 1 and 48 DF,  p-value: 0.01578</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>plot()</code> the model to look for deviations from modeling assumptions.</li>
</ol>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># splits the plotting window into 4 panels</span></a>
<a class="sourceLine" id="cb202-2" data-line-number="2">  <span class="kw">plot</span>(mod_en_met)</a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-102-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Select one or more additional predictors to add to your model and repeat steps 1-3. Is this model significantly better than the model with <em>metro</em> as the only predictor?</li>
</ol>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1">  states_en_met_pop_wst &lt;-<span class="st"> </span><span class="kw">subset</span>(states, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;energy&quot;</span>, <span class="st">&quot;metro&quot;</span>, <span class="st">&quot;pop&quot;</span>, <span class="st">&quot;waste&quot;</span>))</a>
<a class="sourceLine" id="cb203-2" data-line-number="2">  <span class="kw">summary</span>(states_en_met_pop_wst)</a></code></pre></div>
<pre><code>##      energy          metro             pop               waste       
##  Min.   :200.0   Min.   : 20.40   Min.   :  454000   Min.   :0.5400  
##  1st Qu.:285.0   1st Qu.: 46.98   1st Qu.: 1299750   1st Qu.:0.8225  
##  Median :320.0   Median : 67.55   Median : 3390500   Median :0.9600  
##  Mean   :354.5   Mean   : 64.07   Mean   : 4962040   Mean   :0.9888  
##  3rd Qu.:371.5   3rd Qu.: 81.58   3rd Qu.: 5898000   3rd Qu.:1.1450  
##  Max.   :991.0   Max.   :100.00   Max.   :29760000   Max.   :1.5100  
##  NA&#39;s   :1       NA&#39;s   :1        NA&#39;s   :1          NA&#39;s   :1</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">  <span class="kw">plot</span>(states_en_met_pop_wst)</a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-103-1.png" width="672" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1">  <span class="kw">cor</span>(states_en_met_pop_wst, <span class="dt">use =</span> <span class="st">&quot;pairwise&quot;</span>)</a></code></pre></div>
<pre><code>##            energy      metro        pop      waste
## energy  1.0000000 -0.3397445 -0.1840357 -0.2526499
## metro  -0.3397445  1.0000000  0.5653562  0.4877881
## pop    -0.1840357  0.5653562  1.0000000  0.5255713
## waste  -0.2526499  0.4877881  0.5255713  1.0000000</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1">  mod_en_met_pop_waste &lt;-<span class="st"> </span><span class="kw">lm</span>(energy <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>metro <span class="op">+</span><span class="st"> </span>pop <span class="op">+</span><span class="st"> </span>waste, <span class="dt">data =</span> states)</a>
<a class="sourceLine" id="cb208-2" data-line-number="2">  <span class="kw">summary</span>(mod_en_met_pop_waste)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = energy ~ 1 + metro + pop + waste, data = states)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -224.62  -67.48  -31.76   12.65  589.48 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.617e+02  9.905e+01   5.671    9e-07 ***
## metro       -2.079e+00  1.168e+00  -1.780   0.0816 .  
## pop          1.649e-06  4.809e-06   0.343   0.7332    
## waste       -8.307e+01  1.042e+02  -0.797   0.4295    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 142.2 on 46 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.1276, Adjusted R-squared:  0.07067 
## F-statistic: 2.242 on 3 and 46 DF,  p-value: 0.09599</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1">  <span class="kw">anova</span>(mod_en_met, mod_en_met_pop_waste)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: energy ~ metro
## Model 2: energy ~ 1 + metro + pop + waste
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     48 943103                           
## 2     46 930153  2     12949 0.3202 0.7276</code></pre>
</div>
</details>
</div>
</div>
<div id="interactions-factors" class="section level2">
<h2>Interactions &amp; factors</h2>
<div class="alert alert-info">
<p><strong>GOAL: To learn how to specify interaction effects and fit models with categorical predictors.</strong> In particular:</p>
<ol style="list-style-type: decimal">
<li>Formula syntax for interaction effects</li>
<li>Factor levels and labels</li>
<li>Contrasts and pairwise comparisons</li>
</ol>
</div>
<div id="modeling-interactions" class="section level3">
<h3>Modeling interactions</h3>
<p>Interactions allow us assess the extent to which the association between one predictor and the outcome depends on a second predictor. For example: Does the association between expense and SAT scores depend on the median income in the state?</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1">  <span class="co"># Add the interaction to the model</span></a>
<a class="sourceLine" id="cb212-2" data-line-number="2">  sat_expense_by_percent &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>expense <span class="op">+</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>expense <span class="op">:</span><span class="st"> </span>income, <span class="dt">data =</span> states_data)</a>
<a class="sourceLine" id="cb212-3" data-line-number="3"></a>
<a class="sourceLine" id="cb212-4" data-line-number="4">  <span class="co"># same as above, but shorter syntax</span></a>
<a class="sourceLine" id="cb212-5" data-line-number="5">  sat_expense_by_percent &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>expense <span class="op">*</span><span class="st"> </span>income, <span class="dt">data =</span> states_data) </a>
<a class="sourceLine" id="cb212-6" data-line-number="6"></a>
<a class="sourceLine" id="cb212-7" data-line-number="7">  <span class="co"># Show the regression coefficients table</span></a>
<a class="sourceLine" id="cb212-8" data-line-number="8">  <span class="kw">summary</span>(sat_expense_by_percent) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() </a></code></pre></div>
<pre><code>##                     Estimate   Std. Error   t value     Pr(&gt;|t|)
## (Intercept)     1.380364e+03 1.720863e+02  8.021351 2.367069e-10
## expense        -6.384067e-02 3.270087e-02 -1.952262 5.687837e-02
## income         -1.049785e+01 4.991463e+00 -2.103161 4.083253e-02
## expense:income  1.384647e-03 8.635529e-04  1.603431 1.155395e-01</code></pre>
</div>
<div id="regression-with-categorical-predictors" class="section level3">
<h3>Regression with categorical predictors</h3>
<p>Let’s try to predict SAT scores from region, a categorical variable.
Note that you must make sure R does not think your categorical variable is numeric.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1">  <span class="co"># make sure R knows region is categorical</span></a>
<a class="sourceLine" id="cb214-2" data-line-number="2">  <span class="kw">str</span>(states_data<span class="op">$</span>region)</a></code></pre></div>
<pre><code>##  Factor w/ 4 levels &quot;West&quot;,&quot;N. East&quot;,..: 3 1 1 3 1 1 2 3 NA 3 ...</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1">  states_data<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">factor</span>(states_data<span class="op">$</span>region)</a>
<a class="sourceLine" id="cb216-2" data-line-number="2"></a>
<a class="sourceLine" id="cb216-3" data-line-number="3">  <span class="co"># arguments to the factor() function</span></a>
<a class="sourceLine" id="cb216-4" data-line-number="4">  <span class="co"># factor(x, levels, labels)</span></a>
<a class="sourceLine" id="cb216-5" data-line-number="5"></a>
<a class="sourceLine" id="cb216-6" data-line-number="6">  <span class="kw">levels</span>(states_data<span class="op">$</span>region)</a></code></pre></div>
<pre><code>## [1] &quot;West&quot;    &quot;N. East&quot; &quot;South&quot;   &quot;Midwest&quot;</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1">  <span class="co"># Add region to the model</span></a>
<a class="sourceLine" id="cb218-2" data-line-number="2">  sat_region &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>region, <span class="dt">data =</span> states_data) </a>
<a class="sourceLine" id="cb218-3" data-line-number="3"></a>
<a class="sourceLine" id="cb218-4" data-line-number="4">  <span class="co"># Show the results</span></a>
<a class="sourceLine" id="cb218-5" data-line-number="5">  <span class="kw">summary</span>(sat_region) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>() <span class="co"># show the regression coefficients table</span></a></code></pre></div>
<pre><code>##                Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)   946.30769   14.79582 63.9577807 1.352577e-46
## regionN. East -56.75214   23.13285 -2.4533141 1.800383e-02
## regionSouth   -16.30769   19.91948 -0.8186806 4.171898e-01
## regionMidwest  63.77564   21.35592  2.9863209 4.514152e-03</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1">  <span class="kw">anova</span>(sat_region) <span class="co"># show ANOVA table</span></a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: csat
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## region     3  82049 27349.8  9.6102 4.859e-05 ***
## Residuals 46 130912  2845.9                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So, make sure to tell R which variables are categorical by converting them to factors!</p>
</div>
<div id="setting-factor-reference-groups-contrasts" class="section level3">
<h3>Setting factor reference groups &amp; contrasts</h3>
<p><strong>Contrasts</strong> is the umbrella term used to describe the process of testing linear combinations of parameters from regression models.
All statistical sofware use contrasts, but each sofware has different defaults and their own way of overriding these.</p>
<p>The default contrasts in R are “treatment” contrasts (aka “dummy coding”), where each level within a factor
is identified within a matrix of binary <code>0</code> / <code>1</code> variables, with the first level chosen as the reference category.
They’re called “treatment” contrasts, because of the typical use case where there is one control group (the reference group)
and one or more treatment groups that are to be compared to the controls. It is easy to change the default contrasts to something
other than treatment contrasts, though this is rarely needed. More often, we may want to change the reference group in
treatment contrasts or get all sets of pairwise contrasts between factor levels.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1">  <span class="co"># change the reference group</span></a>
<a class="sourceLine" id="cb222-2" data-line-number="2">  states_data<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">relevel</span>(states_data<span class="op">$</span>region, <span class="dt">ref =</span> <span class="st">&quot;Midwest&quot;</span>)</a>
<a class="sourceLine" id="cb222-3" data-line-number="3">  m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(csat <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>region, <span class="dt">data =</span> states_data)</a>
<a class="sourceLine" id="cb222-4" data-line-number="4">  <span class="kw">summary</span>(m1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>##                 Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)   1010.08333   15.39998 65.589930 4.296307e-47
## regionWest     -63.77564   21.35592 -2.986321 4.514152e-03
## regionN. East -120.52778   23.52385 -5.123641 5.798399e-06
## regionSouth    -80.08333   20.37225 -3.931000 2.826007e-04</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1">  <span class="co"># get all pairwise contrasts between means</span></a>
<a class="sourceLine" id="cb224-2" data-line-number="2">  means &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m1, <span class="dt">specs =</span> <span class="op">~</span><span class="st"> </span>region)</a>
<a class="sourceLine" id="cb224-3" data-line-number="3">  means</a></code></pre></div>
<pre><code>##  region  emmean   SE df lower.CL upper.CL
##  Midwest   1010 15.4 46      979     1041
##  West       946 14.8 46      917      976
##  N. East    890 17.8 46      854      925
##  South      930 13.3 46      903      957
## 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">  <span class="kw">contrast</span>(means, <span class="dt">method =</span> <span class="st">&quot;pairwise&quot;</span>)</a></code></pre></div>
<pre><code>##  contrast          estimate   SE df t.ratio p.value
##  Midwest - West        63.8 21.4 46  2.986  0.0226 
##  Midwest - N. East    120.5 23.5 46  5.124  &lt;.0001 
##  Midwest - South       80.1 20.4 46  3.931  0.0016 
##  West - N. East        56.8 23.1 46  2.453  0.0812 
##  West - South          16.3 19.9 46  0.819  0.8453 
##  N. East - South      -40.4 22.2 46 -1.820  0.2774 
## 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
</div>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Interactions &amp; factors</strong></p>
<p>Use the <code>states</code> data set.</p>
<ol style="list-style-type: decimal">
<li>Add on to the regression equation that you created in Exercise 1 by generating an interaction term and testing the interaction.</li>
</ol>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Try adding region to the model. Are there significant differences across the four regions?</li>
</ol>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<details>
<summary><span style="color:red"><b>Click for Exercise 1 Solution</b></span></summary>
<div class="alert alert-success">
<p>Use the states data set.</p>
<ol style="list-style-type: decimal">
<li>Add on to the regression equation that you created in exercise 1 by generating an interaction term and testing the interaction.</li>
</ol>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1">  mod_en_metro_by_waste &lt;-<span class="st"> </span><span class="kw">lm</span>(energy <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>metro <span class="op">*</span><span class="st"> </span>waste, <span class="dt">data =</span> states)</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Try adding a region to the model. Are there significant differences across the four regions?</li>
</ol>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1">  mod_en_region &lt;-<span class="st"> </span><span class="kw">lm</span>(energy <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>metro <span class="op">*</span><span class="st"> </span>waste <span class="op">+</span><span class="st"> </span>region, <span class="dt">data =</span> states)</a>
<a class="sourceLine" id="cb231-2" data-line-number="2">  <span class="kw">anova</span>(mod_en_region)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: energy
##             Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## metro        1 123064  123064  6.4435 0.01484 *
## waste        1  10572   10572  0.5535 0.46093  
## region       3 111128   37043  1.9395 0.13749  
## metro:waste  1    156     156  0.0082 0.92835  
## Residuals   43 821247   19099                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</details>
</div>
</div>
<div id="models-with-binary-outcomes" class="section level2">
<h2>Models with binary outcomes</h2>
<div class="alert alert-info">
<p><strong>GOAL: To learn how to use the <code>glm()</code> function to model binary outcomes.</strong> In particular:</p>
<ol style="list-style-type: decimal">
<li>The <code>family</code> and <code>link</code> components of the <code>glm()</code> function call</li>
<li>Transforming model coefficients into odds ratios</li>
<li>Transforming model coefficients into predicted marginal means</li>
</ol>
</div>
<div id="logistic-regression" class="section level3">
<h3>Logistic regression</h3>
<p>This far we have used the <code>lm()</code> function to fit our regression models. <code>lm()</code> is great, but limited — in particular it only fits models for continuous dependent variables. For categorical dependent variables we can use the <code>glm()</code> function.</p>
<p>For these models we will use a different dataset, drawn from the National Health Interview Survey. From the <a href="http://www.cdc.gov/nchs/nhis.htm">CDC website</a>:</p>
<blockquote>
<p>The National Health Interview Survey (NHIS) has monitored the health of the nation since 1957. NHIS data on a broad range of health topics are collected through personal household interviews. For over 50 years, the U.S. Census Bureau has been the data collection agent for the National Health Interview Survey. Survey results have been instrumental in providing data to track health status, health care access, and progress toward achieving national health objectives.</p>
</blockquote>
<p>Load the National Health Interview Survey data:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" data-line-number="1">  NH11 &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;dataSets/NatHealth2011.rds&quot;</span>)</a></code></pre></div>
</div>
<div id="logistic-regression-example" class="section level3">
<h3>Logistic regression example</h3>
<p>Motivation for a logistic regression model — with a binary response:</p>
<ol style="list-style-type: decimal">
<li>Errors will not be normally distributed</li>
<li>Variance will not be homoskedastic</li>
<li>Predictions should be constrained to be on the interval [0, 1]</li>
</ol>
<p><img src="R/Rmodels/images/logistic.png" /></p>
<p>Anatomy of a generalized linear model:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">  <span class="co"># OLS model using lm()</span></a>
<a class="sourceLine" id="cb234-2" data-line-number="2">  <span class="kw">lm</span>(outcome <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2, </a>
<a class="sourceLine" id="cb234-3" data-line-number="3">     <span class="dt">data =</span> mydata)</a>
<a class="sourceLine" id="cb234-4" data-line-number="4"></a>
<a class="sourceLine" id="cb234-5" data-line-number="5">  <span class="co"># OLS model using glm()</span></a>
<a class="sourceLine" id="cb234-6" data-line-number="6">  <span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2, </a>
<a class="sourceLine" id="cb234-7" data-line-number="7">      <span class="dt">data =</span> mydata, </a>
<a class="sourceLine" id="cb234-8" data-line-number="8">      <span class="dt">family =</span> <span class="kw">gaussian</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>))</a>
<a class="sourceLine" id="cb234-9" data-line-number="9"> </a>
<a class="sourceLine" id="cb234-10" data-line-number="10">  <span class="co"># logistic model using glm()</span></a>
<a class="sourceLine" id="cb234-11" data-line-number="11">  <span class="kw">glm</span>(outcome <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2, </a>
<a class="sourceLine" id="cb234-12" data-line-number="12">      <span class="dt">data =</span> mydata, </a>
<a class="sourceLine" id="cb234-13" data-line-number="13">      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</a></code></pre></div>
<p>The <code>family</code> argument sets the error distribution for the model, while the <code>link</code> function
argument relates the predictors to the expected value of the outcome.</p>
<p>Let’s predict the probability of being diagnosed with hypertension based on <code>age</code>, <code>sex</code>, <code>sleep</code>, and <code>bmi</code>.
Here’s the model:</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
logit(hypev_i) = \beta_01 + \beta_1agep_i + \beta_2sex_i + \beta_3sleep_i + \beta_4bmi_i + \epsilon_i 
\]</span></p>
</div>
<p>where <span class="math inline">\(logit(\cdot)\)</span> is the link function, which is equivalent to the log odds of <code>hypev</code>:</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
logit(hypev_i) = ln \frac{p(hypev_i = 1)}{p(hypev_i = 0)}
\]</span></p>
</div>
<p>And here’s how we fit this in R. First, let’s clean up the hypertension outcome by making it binary:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" data-line-number="1">  <span class="kw">str</span>(NH11<span class="op">$</span>hypev) <span class="co"># check stucture of hypev</span></a></code></pre></div>
<pre><code>##  Factor w/ 5 levels &quot;1 Yes&quot;,&quot;2 No&quot;,..: 2 2 1 2 2 1 2 2 1 2 ...</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1">  <span class="kw">levels</span>(NH11<span class="op">$</span>hypev) <span class="co"># check levels of hypev</span></a></code></pre></div>
<pre><code>## [1] &quot;1 Yes&quot;             &quot;2 No&quot;              &quot;7 Refused&quot;        
## [4] &quot;8 Not ascertained&quot; &quot;9 Don&#39;t know&quot;</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1">  <span class="co"># collapse all missing values to NA</span></a>
<a class="sourceLine" id="cb239-2" data-line-number="2">  NH11<span class="op">$</span>hypev &lt;-<span class="st"> </span><span class="kw">factor</span>(NH11<span class="op">$</span>hypev, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;2 No&quot;</span>, <span class="st">&quot;1 Yes&quot;</span>))</a></code></pre></div>
<p>Now let’s use <code>glm()</code> to estimate the model:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1">  <span class="co"># run our regression model</span></a>
<a class="sourceLine" id="cb240-2" data-line-number="2">  hyp_out &lt;-<span class="st"> </span><span class="kw">glm</span>(hypev <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age_p <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>sleep <span class="op">+</span><span class="st"> </span>bmi,</a>
<a class="sourceLine" id="cb240-3" data-line-number="3">                 <span class="dt">data =</span> NH11, </a>
<a class="sourceLine" id="cb240-4" data-line-number="4">                 <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</a>
<a class="sourceLine" id="cb240-5" data-line-number="5"></a>
<a class="sourceLine" id="cb240-6" data-line-number="6">  <span class="kw">summary</span>(hyp_out) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>##                 Estimate   Std. Error    z value     Pr(&gt;|z|)
## (Intercept) -4.269466028 0.0564947294 -75.572820 0.000000e+00
## age_p        0.060699303 0.0008227207  73.778743 0.000000e+00
## sex2 Female -0.144025092 0.0267976605  -5.374540 7.677854e-08
## sleep       -0.007035776 0.0016397197  -4.290841 1.779981e-05
## bmi          0.018571704 0.0009510828  19.526906 6.485172e-85</code></pre>
</div>
<div id="odds-ratios" class="section level3">
<h3>Odds ratios</h3>
<p>Generalized linear models use link functions to relate the average value of the response to the predictors,
so raw coefficients are difficult to interpret. For example, the <code>age</code> coefficient of .06 in the previous
model tells us that for every one unit increase in <code>age</code>, the log odds of hypertension diagnosis increases
by 0.06. Since most of us are not used to thinking in log odds this is not too helpful!</p>
<p>One solution is to transform the coefficients to make them easier to interpret.
Here we transform them into odds ratios by exponentiating:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" data-line-number="1">  <span class="co"># point estimates</span></a>
<a class="sourceLine" id="cb242-2" data-line-number="2">  <span class="kw">coef</span>(hyp_out) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</a></code></pre></div>
<pre><code>## (Intercept)       age_p sex2 Female       sleep         bmi 
##  0.01398925  1.06257935  0.86586602  0.99298892  1.01874523</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" data-line-number="1">  <span class="co"># confidence intervals</span></a>
<a class="sourceLine" id="cb244-2" data-line-number="2">  <span class="kw">confint</span>(hyp_out) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</a></code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 0.01251677 0.01561971
## age_p       1.06087385 1.06430082
## sex2 Female 0.82155196 0.91255008
## sleep       0.98978755 0.99617465
## bmi         1.01685145 1.02065009</code></pre>
</div>
<div id="predicted-marginal-means" class="section level3">
<h3>Predicted marginal means</h3>
<p>Instead of reporting odds ratios, we may want to calculate predicted marginal means (sometimes called “least squares means”).
These are average values of the outcome at particular levels of the predictors. For ease of interpretation, we want these
marginal means to be on the response scale (i.e., the probability scale). We can use the <code>effects</code> package to compute
these quantities of interest for us (by default, the numerical output will be on the response scale).</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" data-line-number="1">  eff &lt;-<span class="st"> </span><span class="kw">allEffects</span>(hyp_out)</a>
<a class="sourceLine" id="cb246-2" data-line-number="2">  <span class="kw">plot</span>(eff, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># &quot;response&quot; refers to the probability scale</span></a></code></pre></div>
<p><img src="R/Rmodels/figures/unnamed-chunk-117-1.png" width="672" /></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" data-line-number="1">  <span class="co"># generate a sequence at which to get predictions of the outcome</span></a>
<a class="sourceLine" id="cb247-2" data-line-number="2">  <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##  [1] 20 25 30 35 40 45 50 55 60 65 70 75 80</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" data-line-number="1">  <span class="co"># override defaults</span></a>
<a class="sourceLine" id="cb249-2" data-line-number="2">  eff &lt;-<span class="st"> </span><span class="kw">allEffects</span>(hyp_out, <span class="dt">xlevels =</span> <span class="kw">list</span>(<span class="dt">age_p =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb249-3" data-line-number="3">  eff_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(eff) <span class="co"># confidence intervals</span></a>
<a class="sourceLine" id="cb249-4" data-line-number="4">  eff_df</a></code></pre></div>
<pre><code>## $age_p
##    age_p        fit          se      lower      upper
## 1     20 0.06690384 0.001915704 0.06324553 0.07075778
## 2     25 0.08852692 0.002181618 0.08434323 0.09289708
## 3     30 0.11626770 0.002418813 0.11161020 0.12109307
## 4     35 0.15125876 0.002603243 0.14622690 0.15643204
## 5     40 0.19446321 0.002722428 0.18918282 0.19985467
## 6     45 0.24642528 0.002796260 0.24098582 0.25194677
## 7     50 0.30698073 0.002895857 0.30133437 0.31268554
## 8     55 0.37501156 0.003124112 0.36890868 0.38115441
## 9     60 0.44836479 0.003531792 0.44145305 0.45529654
## 10    65 0.52403564 0.004052454 0.51608756 0.53197156
## 11    70 0.59861876 0.004545531 0.58967801 0.60749436
## 12    75 0.66889903 0.004880732 0.65926418 0.67839434
## 13    80 0.73237506 0.004986539 0.72248912 0.74203457
## 
## $sex
##        sex       fit          se     lower     upper
## 1   1 Male 0.2994186 0.004188707 0.2912739 0.3076922
## 2 2 Female 0.2701044 0.003715028 0.2628852 0.2774472
## 
## $sleep
##   sleep       fit          se     lower     upper
## 1     3 0.2899941 0.003276427 0.2836147 0.2964575
## 2    30 0.2524895 0.007427001 0.2382124 0.2673219
## 3    50 0.2268657 0.012446183 0.2034008 0.2521806
## 4    80 0.1919843 0.018549461 0.1582199 0.2309771
## 5   100 0.1710955 0.021584286 0.1328287 0.2176200
## 
## $bmi
##   bmi       fit          se     lower     upper
## 1  10 0.2144084 0.004121590 0.2064409 0.2225972
## 2  30 0.2835093 0.002849407 0.2779580 0.2891272
## 3  60 0.4085485 0.007450161 0.3940311 0.4232272
## 4  80 0.5003663 0.012139141 0.4765911 0.5241398
## 5 100 0.5921593 0.016180071 0.5601051 0.6234481</code></pre>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Logistic regression</strong></p>
<p>Use the <code>NH11</code> data set that we loaded earlier.</p>
<ol style="list-style-type: decimal">
<li>Use <code>glm()</code> to conduct a logistic regression to predict ever worked (<code>everwrk</code>) using age (<code>age_p</code>) and marital status (<code>r_maritl</code>). Make sure you only keep the following two levels for <code>everwrk</code> (<code>1 Yes</code> and <code>2 No</code>). Hint: use the <code>factor()</code> function. Also, make sure to drop any <code>r_maritl</code> levels that do not contain observations. Hint: see <code>?droplevels</code>.</li>
</ol>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Predict the probability of working for each level of marital status. Hint: use <code>allEffects()</code></li>
</ol>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<p>Note that the data are not perfectly clean and ready to be modeled. You will need to clean up at least some of the variables before fitting the model.</p>
<details>
<summary><span style="color:red"><b>Click for Exercise 2 Solution</b></span></summary>
<div class="alert alert-success">
<p>Use the NH11 data set that we loaded earlier. Note that the data is not perfectly clean and ready to be modeled. You will need to clean up at least some of the variables before fitting the model.</p>
<ol style="list-style-type: decimal">
<li>Use <code>glm()</code> to conduct a logistic regression to predict ever worked (<code>everwrk</code>) using age (<code>age_p</code>) and marital status (<code>r_maritl</code>). Make sure you only keep the following two levels for <code>everwrk</code> (<code>1 Yes</code> and <code>2 No</code>). Hint: use the <code>factor()</code> function. Also, make sure to drop any <code>r_maritl</code> levels that do not contain observations. Hint: see <code>?droplevels</code>.</li>
</ol>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1">  NH11 &lt;-<span class="st"> </span><span class="kw">mutate</span>(NH11,</a>
<a class="sourceLine" id="cb253-2" data-line-number="2">                     <span class="dt">everwrk =</span> <span class="kw">factor</span>(everwrk, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1 Yes&quot;</span>, <span class="st">&quot;2 No&quot;</span>)),</a>
<a class="sourceLine" id="cb253-3" data-line-number="3">                     <span class="dt">r_maritl =</span> <span class="kw">droplevels</span>(r_maritl))</a>
<a class="sourceLine" id="cb253-4" data-line-number="4"></a>
<a class="sourceLine" id="cb253-5" data-line-number="5">  mod_wk_age_mar &lt;-<span class="st"> </span><span class="kw">glm</span>(everwrk <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age_p <span class="op">+</span><span class="st"> </span>r_maritl, </a>
<a class="sourceLine" id="cb253-6" data-line-number="6">                        <span class="dt">data =</span> NH11,</a>
<a class="sourceLine" id="cb253-7" data-line-number="7">                        <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</a>
<a class="sourceLine" id="cb253-8" data-line-number="8"></a>
<a class="sourceLine" id="cb253-9" data-line-number="9">  <span class="kw">summary</span>(mod_wk_age_mar)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = everwrk ~ 1 + age_p + r_maritl, family = binomial(link = &quot;logit&quot;), 
##     data = NH11)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.0436  -0.5650  -0.4391  -0.3370   2.7308  
## 
## Coefficients:
##                                              Estimate Std. Error z value
## (Intercept)                                 -0.440248   0.093538  -4.707
## age_p                                       -0.029812   0.001645 -18.118
## r_maritl2 Married - spouse not in household  0.049675   0.217310   0.229
## r_maritl4 Widowed                            0.683618   0.084335   8.106
## r_maritl5 Divorced                          -0.730115   0.111681  -6.538
## r_maritl6 Separated                         -0.128091   0.151366  -0.846
## r_maritl7 Never married                      0.343611   0.069222   4.964
## r_maritl8 Living with partner               -0.443583   0.137770  -3.220
## r_maritl9 Unknown marital status             0.395480   0.492967   0.802
##                                             Pr(&gt;|z|)    
## (Intercept)                                 2.52e-06 ***
## age_p                                        &lt; 2e-16 ***
## r_maritl2 Married - spouse not in household  0.81919    
## r_maritl4 Widowed                           5.23e-16 ***
## r_maritl5 Divorced                          6.25e-11 ***
## r_maritl6 Separated                          0.39742    
## r_maritl7 Never married                     6.91e-07 ***
## r_maritl8 Living with partner                0.00128 ** 
## r_maritl9 Unknown marital status             0.42241    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 11082  on 14039  degrees of freedom
## Residual deviance: 10309  on 14031  degrees of freedom
##   (18974 observations deleted due to missingness)
## AIC: 10327
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Predict the probability of working for each level of marital status. Hint: use <code>allEffects()</code>.</li>
</ol>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1">  eff &lt;-<span class="st"> </span><span class="kw">allEffects</span>(mod_wk_age_mar)</a>
<a class="sourceLine" id="cb255-2" data-line-number="2">  <span class="kw">as.data.frame</span>(eff)</a></code></pre></div>
<pre><code>## $age_p
##   age_p        fit          se      lower      upper
## 1    20 0.27587439 0.011448539 0.25400910 0.29886780
## 2    30 0.22043363 0.007483648 0.20611629 0.23545053
## 3    50 0.13477473 0.003183752 0.12865574 0.14113761
## 4    70 0.07902788 0.003053617 0.07324630 0.08522385
## 5    80 0.05987515 0.003123927 0.05403759 0.06629914
## 
## $r_maritl
##                              r_maritl        fit          se      lower
## 1     1 Married - spouse in household 0.10822000 0.004259644 0.10014980
## 2 2 Married - spouse not in household 0.11310823 0.021393167 0.07746061
## 3                           4 Widowed 0.19381087 0.010634762 0.17381358
## 4                          5 Divorced 0.05524394 0.005361664 0.04562877
## 5                         6 Separated 0.09646417 0.012707502 0.07426824
## 6                     7 Never married 0.14611000 0.007459212 0.13208775
## 7               8 Living with partner 0.07224958 0.008904955 0.05662466
## 8            9 Unknown marital status 0.15270076 0.063528455 0.06440837
##        upper
## 1 0.11685606
## 2 0.16227532
## 3 0.21550873
## 4 0.06674358
## 5 0.12440219
## 6 0.16134411
## 7 0.09176661
## 8 0.32055728</code></pre>
</div>
</details>
</div>
</div>
<div id="multilevel-modeling" class="section level2">
<h2>Multilevel modeling</h2>
<div class="alert alert-info">
<p><strong>GOAL: To learn about how to use the <code>lmer()</code> function to model clustered data.</strong> In particular:</p>
<ol style="list-style-type: decimal">
<li>The formula syntax for incorporating random effects into a model</li>
<li>Calculating the intraclass correlation (ICC)</li>
<li>Model comparison for fixed and random effects</li>
</ol>
</div>
<div id="multilevel-modeling-overview" class="section level3">
<h3>Multilevel modeling overview</h3>
<ul>
<li>Multi-level (AKA hierarchical) models are a type of <strong>mixed-effects</strong> model</li>
<li>They are used to model data that are clustered (i.e., non-independent)</li>
<li>Mixed-effecs models include two types of predictors: <strong>fixed-effects</strong> and <strong>random effects</strong>
<ul>
<li><strong>Fixed-effects</strong> – observed levels are of direct interest (.e.g, sex, political party…)</li>
<li><strong>Random-effects</strong> – observed levels not of direct interest: goal is to make inferences to a population represented by observed levels</li>
<li>In R, the <code>lme4</code> package is the most popular for mixed effects models</li>
<li>Use the <code>lmer()</code> function for liner mixed models, <code>glmer()</code> for generalized linear mixed models</li>
</ul></li>
</ul>
</div>
<div id="the-exam-data" class="section level3">
<h3>The Exam data</h3>
<p>The Exam data set contans exam scores of 4,059 students from 65 schools in Inner London. The variable names are as follows:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">school</td>
<td align="left">School ID - a factor.</td>
</tr>
<tr class="even">
<td align="left">normexam</td>
<td align="left">Normalized exam score.</td>
</tr>
<tr class="odd">
<td align="left">standLRT</td>
<td align="left">Standardised LR test score.</td>
</tr>
<tr class="even">
<td align="left">student</td>
<td align="left">Student id (within school) - a factor</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" data-line-number="1">  Exam &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;dataSets/Exam.rds&quot;</span>)</a></code></pre></div>
</div>
<div id="the-null-model-icc" class="section level3">
<h3>The null model &amp; ICC</h3>
<p>As a preliminary step it is often useful to partition the variance in the dependent variable into the various levels. This can be accomplished by running a null model (i.e., a model with a random effects grouping structure, but no fixed-effects predictors).</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1">  <span class="co"># anatomy of lmer() function</span></a>
<a class="sourceLine" id="cb258-2" data-line-number="2">  <span class="kw">lmer</span>(outcome <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pred1 <span class="op">+</span><span class="st"> </span>pred2 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>grouping_variable), </a>
<a class="sourceLine" id="cb258-3" data-line-number="3">       <span class="dt">data =</span> mydata, </a>
<a class="sourceLine" id="cb258-4" data-line-number="4">       <span class="dt">REML =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1">  <span class="co"># null model, grouping by school but not fixed effects.</span></a>
<a class="sourceLine" id="cb259-2" data-line-number="2">  Norm1 &lt;-<span class="kw">lmer</span>(normexam <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), </a>
<a class="sourceLine" id="cb259-3" data-line-number="3">              <span class="dt">data =</span> <span class="kw">na.omit</span>(Exam), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb259-4" data-line-number="4">  <span class="kw">summary</span>(Norm1)</a></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: normexam ~ 1 + (1 | school)
##    Data: na.omit(Exam)
## 
##      AIC      BIC   logLik deviance df.resid 
##   9964.9   9983.5  -4979.4   9958.9     3659 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.8751 -0.6460  0.0045  0.6898  3.6842 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept) 0.1606   0.4007  
##  Residual             0.8520   0.9231  
## Number of obs: 3662, groups:  school, 65
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) -0.01301    0.05270  -0.247</code></pre>
<p>The is .161/(.161 + .852) = .159 = 16% of the variance is at the school level.</p>
<p>There is no consensus on how to calculate p-values for MLMs; hence why they are omitted from the <code>lme4</code> output.
But, if you really need p-values, the <code>lmerTest</code> package will calculate p-values for you (using the Satterthwaite
approximation).</p>
</div>
<div id="adding-fixed-effects-predictors" class="section level3">
<h3>Adding fixed-effects predictors</h3>
<p>Here’s a model that predicts exam scores from student’s standardized tests scores:</p>
<div class="alert alert-secondary">
<p><span class="math display">\[
normexam_{ij} = \mu + \beta_1standLRT_{ij} + U_{0j} + \epsilon_{ij}
\]</span></p>
</div>
<p>where <span class="math inline">\(U_{0j}\)</span> is the random intercept for <code>school</code>. Let’s implement this in R using <code>lmer()</code>:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" data-line-number="1">  Norm2 &lt;-<span class="kw">lmer</span>(normexam <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>standLRT <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school),</a>
<a class="sourceLine" id="cb261-2" data-line-number="2">               <span class="dt">data =</span> <span class="kw">na.omit</span>(Exam), <span class="dt">REML =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb261-3" data-line-number="3">  <span class="kw">summary</span>(Norm2) </a></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: normexam ~ 1 + standLRT + (1 | school)
##    Data: na.omit(Exam)
## 
##      AIC      BIC   logLik deviance df.resid 
##   8480.1   8505.0  -4236.1   8472.1     3658 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.6722 -0.6300  0.0236  0.6770  3.3347 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept) 0.09197  0.3033  
##  Residual             0.56909  0.7544  
## Number of obs: 3662, groups:  school, 65
## 
## Fixed effects:
##              Estimate Std. Error t value
## (Intercept) 1.913e-05  4.022e-02    0.00
## standLRT    5.670e-01  1.324e-02   42.84
## 
## Correlation of Fixed Effects:
##          (Intr)
## standLRT 0.007</code></pre>
</div>
<div id="multiple-degree-of-freedom-comparisons" class="section level3">
<h3>Multiple degree of freedom comparisons</h3>
<p>As with <code>lm()</code> and <code>glm()</code> models, you can compare the two <code>lmer()</code> models using a likelihood ratio test with the <code>anova()</code> function.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" data-line-number="1">  <span class="kw">anova</span>(Norm1, Norm2)</a></code></pre></div>
<pre><code>## Data: na.omit(Exam)
## Models:
## Norm1: normexam ~ 1 + (1 | school)
## Norm2: normexam ~ 1 + standLRT + (1 | school)
##       Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
## Norm1  3 9964.9 9983.5 -4979.4   9958.9                             
## Norm2  4 8480.1 8505.0 -4236.1   8472.1 1486.8      1  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="random-slopes" class="section level3">
<h3>Random slopes</h3>
<p>Add a random effect of students’ standardized test scores as well. Now in addition to estimating the distribution of intercepts across schools, we also estimate the distribution of the slope of exam on standardized test.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" data-line-number="1">  Norm3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(normexam <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>standLRT <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>standLRT <span class="op">|</span><span class="st"> </span>school), </a>
<a class="sourceLine" id="cb265-2" data-line-number="2">                <span class="dt">data =</span> <span class="kw">na.omit</span>(Exam), <span class="dt">REML =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb265-3" data-line-number="3">  <span class="kw">summary</span>(Norm3) </a></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: normexam ~ 1 + standLRT + (1 + standLRT | school)
##    Data: na.omit(Exam)
## 
##      AIC      BIC   logLik deviance df.resid 
##   8444.1   8481.4  -4216.1   8432.1     3656 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.7894 -0.6233  0.0242  0.6736  3.4372 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  school   (Intercept) 0.08926  0.2988       
##           standLRT    0.01592  0.1262   0.50
##  Residual             0.55591  0.7456       
## Number of obs: 3662, groups:  school, 65
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) -0.01237    0.03978  -0.311
## standLRT     0.56111    0.02100  26.714
## 
## Correlation of Fixed Effects:
##          (Intr)
## standLRT 0.361</code></pre>
</div>
<div id="test-the-significance-of-the-random-slope" class="section level3">
<h3>Test the significance of the random slope</h3>
<p>To test the significance of a random slope just compare models with and without the random slope term using a likelihood ratio test:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1">  <span class="kw">anova</span>(Norm2, Norm3) </a></code></pre></div>
<pre><code>## Data: na.omit(Exam)
## Models:
## Norm2: normexam ~ 1 + standLRT + (1 | school)
## Norm3: normexam ~ 1 + standLRT + (1 + standLRT | school)
##       Df    AIC    BIC  logLik deviance Chisq Chi Df Pr(&gt;Chisq)    
## Norm2  4 8480.1 8505.0 -4236.1   8472.1                            
## Norm3  6 8444.1 8481.4 -4216.1   8432.1 40.01      2  2.051e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="exercise-3-1" class="section level3">
<h3>Exercise 3</h3>
<p><strong>Multilevel modeling</strong></p>
<p>Use the <code>bh1996</code> dataset:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" data-line-number="1"><span class="co">## install.packages(&quot;multilevel&quot;)</span></a>
<a class="sourceLine" id="cb269-2" data-line-number="2"><span class="kw">data</span>(bh1996, <span class="dt">package=</span><span class="st">&quot;multilevel&quot;</span>)</a></code></pre></div>
<p>From the data documentation:</p>
<blockquote>
<p>Variables are Leadership Climate (<code>LEAD</code>), Well-Being (<code>WBEING</code>), and Work Hours (<code>HRS</code>). The group identifier is named <code>GRP</code>.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Create a null model predicting wellbeing (<code>WBEING</code>)</li>
</ol>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Calculate the ICC for your null model</li>
</ol>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Run a second multi-level model that adds two individual-level predictors, average number of hours worked (<code>HRS</code>) and leadership skills (<code>LEAD</code>) to the model and interpret your output.</li>
</ol>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Now, add a random effect of average number of hours worked (<code>HRS</code>) to the model and interpret your output. Test the significance of this random term.</li>
</ol>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="co">## </span></a></code></pre></div>
<details>
<summary><span style="color:red"><b>Click for Exercise 3 Solution</b></span></summary>
<div class="alert alert-success">
<p>Use the dataset, bh1996:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" data-line-number="1">  <span class="kw">data</span>(bh1996, <span class="dt">package=</span><span class="st">&quot;multilevel&quot;</span>)</a></code></pre></div>
<p>From the data documentation:</p>
<blockquote>
<p>Variables are Leadership Climate (<code>LEAD</code>), Well-Being (<code>WBEING</code>), and Work Hours (<code>HRS</code>). The group identifier is named <code>GRP</code>.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Create a null model predicting wellbeing (<code>WBEING</code>).</li>
</ol>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" data-line-number="1">  mod_grp0 &lt;-<span class="st"> </span><span class="kw">lmer</span>(WBEING <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>GRP), <span class="dt">data =</span> bh1996)</a>
<a class="sourceLine" id="cb275-2" data-line-number="2">  <span class="kw">summary</span>(mod_grp0)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: WBEING ~ 1 + (1 | GRP)
##    Data: bh1996
## 
## REML criterion at convergence: 19347.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.3217 -0.6475  0.0311  0.7182  2.6674 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  GRP      (Intercept) 0.0358   0.1892  
##  Residual             0.7895   0.8885  
## Number of obs: 7382, groups:  GRP, 99
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   2.7743     0.0222   124.9</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Run a second multi-level model that adds two individual-level predictors, average number of hours worked (<code>HRS</code>) and leadership skills (<code>LEAD</code>) to the model and interpret your output.</li>
</ol>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1">  mod_grp1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(WBEING <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>HRS <span class="op">+</span><span class="st"> </span>LEAD <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>GRP), <span class="dt">data =</span> bh1996)</a>
<a class="sourceLine" id="cb277-2" data-line-number="2">  <span class="kw">summary</span>(mod_grp1)</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: WBEING ~ 1 + HRS + LEAD + (1 | GRP)
##    Data: bh1996
## 
## REML criterion at convergence: 17860
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.9188 -0.6588  0.0382  0.7040  3.6440 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  GRP      (Intercept) 0.01929  0.1389  
##  Residual             0.64668  0.8042  
## Number of obs: 7382, groups:  GRP, 99
## 
## Fixed effects:
##              Estimate Std. Error t value
## (Intercept)  1.686160   0.067702  24.906
## HRS         -0.031617   0.004378  -7.221
## LEAD         0.500743   0.012811  39.087
## 
## Correlation of Fixed Effects:
##      (Intr) HRS   
## HRS  -0.800       
## LEAD -0.635  0.121</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Now, add a random effect of average number of hours worked (<code>HRS</code>) to the model and interpret your output. Test the significance of this random term.</li>
</ol>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" data-line-number="1">  mod_grp2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(WBEING <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>HRS <span class="op">+</span><span class="st"> </span>LEAD <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>HRS <span class="op">|</span><span class="st"> </span>GRP), <span class="dt">data =</span> bh1996)</a>
<a class="sourceLine" id="cb279-2" data-line-number="2">  <span class="kw">anova</span>(mod_grp1, mod_grp2)</a></code></pre></div>
<pre><code>## Data: bh1996
## Models:
## mod_grp1: WBEING ~ 1 + HRS + LEAD + (1 | GRP)
## mod_grp2: WBEING ~ 1 + HRS + LEAD + (1 + HRS | GRP)
##          Df   AIC   BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
## mod_grp1  5 17848 17882 -8918.9    17838                         
## mod_grp2  7 17851 17899 -8918.3    17837 1.2202      2     0.5433</code></pre>
</div>
</details>
</div>
</div>
<div id="wrap-up-2" class="section level2">
<h2>Wrap-up</h2>
<div id="feedback-2" class="section level3">
<h3>Feedback</h3>
<p>These workshops are a work in progress, please provide any feedback to: <a href="mailto:help@iq.harvard.edu">help@iq.harvard.edu</a></p>
</div>
<div id="resources-3" class="section level3">
<h3>Resources</h3>
<ul>
<li>IQSS
<ul>
<li>Workshops: <a href="https://dss.iq.harvard.edu/workshop-materials" class="uri">https://dss.iq.harvard.edu/workshop-materials</a></li>
<li>Data Science Services: <a href="https://dss.iq.harvard.edu/" class="uri">https://dss.iq.harvard.edu/</a></li>
<li>Research Computing Environment: <a href="https://iqss.github.io/dss-rce/" class="uri">https://iqss.github.io/dss-rce/</a></li>
</ul></li>
<li>HBS
<ul>
<li>Research Computing Services workshops: <a href="https://training.rcs.hbs.org/workshops" class="uri">https://training.rcs.hbs.org/workshops</a></li>
<li>Other HBS RCS resources: <a href="https://training.rcs.hbs.org/workshop-materials" class="uri">https://training.rcs.hbs.org/workshop-materials</a></li>
<li>RCS consulting email: <a href="mailto:research@hbs.edu">mailto:research@hbs.edu</a></li>
</ul></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Rintro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Rgraphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/IQSS/dss-workshops/edit/master/R/Rmodels/Rmodels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data_Science_Workshops.pdf", "Data_Science_Workshops.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
